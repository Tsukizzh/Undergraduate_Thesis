# P450酶物种分类方法详解（零基础版）

**创建时间**：2026-01-03
**目标读者**：对生物信息学和编程不熟悉的研究人员

---

## 目录

1. [我们要解决什么问题？](#一我们要解决什么问题)
2. [什么是物种分类？](#二什么是物种分类)
3. [我们的数据从哪来？](#三我们的数据从哪来)
4. [分类方案是怎么设计的？](#四分类方案是怎么设计的)
5. [程序是怎么运行的？](#五程序是怎么运行的)
6. [如何判断一个酶属于哪个类别？](#六如何判断一个酶属于哪个类别)
7. [输出了什么结果？](#七输出了什么结果)
8. [关键发现是什么？](#八关键发现是什么)

---

## 一、我们要解决什么问题？

### 1.1 背景回顾

在之前的工作中，我们从EZSpecificity的训练数据（共25,225个酶）中，筛选出了**389个真正的P450酶**。

现在的问题是：**这389个P450酶分别来自什么生物？**

```
为什么要知道这个？
├── 如果训练数据中有来自"罂粟"的P450 → 那用EZSpecificity预测罂粟P450可能不公平
├── 如果训练数据中没有来自"罂粟"的P450 → 那用EZSpecificity预测罂粟P450是公平的
└── 我们特别关心：苄基异喹啉生物碱(BIA)相关的P450是否在训练数据中
```

### 1.2 任务目标

把389个P450酶按照**来源物种**分成几个大类：

| 我们关心的类别 | 为什么关心 |
|---------------|-----------|
| 哺乳动物（人、小鼠等） | 药物代谢研究常用 |
| BIA生产植物（罂粟、黄连等） | 这是我们benchmark的目标！ |
| 其他植物（拟南芥、水稻等） | 植物代谢研究 |
| 细菌 | 结构研究常用 |
| 真菌 | 生物合成研究 |

---

## 二、什么是物种分类？

### 2.1 生物分类学基础

生物学家把地球上的生物按照"亲缘关系"分成不同的层级，就像家谱一样：

```
生物分类层级（从大到小）：
域 (Domain)     → 例如：真核生物域 (Eukaryota)
    └── 界 (Kingdom)  → 例如：植物界 (Viridiplantae)
        └── 门 (Phylum)   → 例如：被子植物门
            └── 纲 (Class)    → 例如：双子叶植物纲
                └── 目 (Order)    → 例如：毛茛目 (Ranunculales)  ← 我们重点关注这个！
                    └── 科 (Family)   → 例如：罂粟科 (Papaveraceae)
                        └── 属 (Genus)    → 例如：罂粟属 (Papaver)
                            └── 种 (Species) → 例如：鸦片罂粟 (Papaver somniferum)
```

### 2.2 举个实际例子

以"鸦片罂粟"为例，它的完整分类谱系是：

```
鸦片罂粟 (Papaver somniferum) 的"家谱"：

真核生物域 (Eukaryota)
    └── 植物界 (Viridiplantae)      ← 看到这个词，就知道是植物
        └── 链形植物门 (Streptophyta)
            └── 有胚植物 (Embryophyta)
                └── 被子植物纲 (Magnoliopsida)
                    └── 毛茛目 (Ranunculales)  ← 看到这个词，就知道可能产BIA！
                        └── 罂粟科 (Papaveraceae)  ← 确认是BIA生产植物
                            └── 罂粟属 (Papaver)
                                └── 鸦片罂粟 (Papaver somniferum)
```

### 2.3 什么是BIA生产植物？

**BIA = Benzylisoquinoline Alkaloids = 苄基异喹啉生物碱**

这是一类重要的植物次生代谢产物，包括：
- 吗啡 (Morphine) - 来自罂粟
- 小檗碱 (Berberine) - 来自黄连
- 血根碱 (Sanguinarine) - 来自白屈菜

**能生产BIA的植物主要集中在"毛茛目"(Ranunculales)**，包括：

| 科名 | 中文名 | 代表植物 |
|------|--------|----------|
| Papaveraceae | 罂粟科 | 鸦片罂粟、加州罂粟、白屈菜 |
| Ranunculaceae | 毛茛科 | 黄连 |
| Berberidaceae | 小檗科 | 小檗、鬼臼 |

---

## 三、我们的数据从哪来？

### 3.1 输入数据

我们的输入是之前阶段产出的文件：

```
文件位置：2026-01-02_01-46_P450精确验证/P450酶列表_最终版389个.csv
文件内容：389个经过UniProt验证的真正P450酶
```

这个CSV文件长这样（简化版）：

| uniprot_id | protein_families | has_heme |
|------------|------------------|----------|
| P05177 | Cytochrome P450 family | True |
| Q9NYL5 | Cytochrome P450 family | True |
| P10635 | Cytochrome P450 family | True |
| ... | ... | ... |

**问题**：这个文件只有UniProt ID，没有物种信息！

### 3.2 如何获取物种信息？

我们需要用**UniProt数据库的API**来查询每个酶的物种信息。

```
什么是API？

API = Application Programming Interface = 应用程序编程接口

通俗理解：API就像一个"服务窗口"
├── 你提交一个"请求"（比如：告诉我P05177是什么物种的）
├── 服务窗口处理你的请求
└── 服务窗口返回"响应"（比如：P05177来自人类Homo sapiens）

我们用的是UniProt的API：https://rest.uniprot.org/
```

### 3.3 查询过程示意图

```
我们的程序                           UniProt服务器
    │                                      │
    │  ① 发送请求：请告诉我P05177的物种信息  │
    │ ─────────────────────────────────────> │
    │                                      │
    │  ② 返回响应：P05177来自Homo sapiens    │
    │ <───────────────────────────────────── │
    │     物种ID: 9606                       │
    │     分类谱系: Eukaryota, Metazoa,      │
    │               Mammalia, Homo           │
    │                                      │
```

---

## 四、分类方案是怎么设计的？

### 4.1 为什么需要讨论？

一开始我们只知道"要按物种分类"，但具体怎么分，分几类，怎么判断，都不清楚。

所以我和两个AI助手（Codex和Gemini）进行了讨论。

### 4.2 Codex的建议（技术层面）

Codex擅长后端逻辑，它建议：

```
1. 使用UniProt REST API获取分类学信息
   - 需要查询的字段：accession（ID）, organism_name（物种名）, lineage（谱系）

2. 通过分析"lineage"字符串来判断物种大类
   - 如果lineage包含"Bacteria" → 这是细菌
   - 如果lineage包含"Viridiplantae" → 这是植物
   - 如果lineage包含"Mammalia" → 这是哺乳动物

3. 批量查询以提高效率
   - 每次查100个ID，避免请求过大
```

### 4.3 Gemini的建议（生物学层面）

Gemini擅长需求理解，它建议：

```
1. 重点关注BIA生产植物
   - BIA相关P450主要是CYP80和CYP719家族
   - 这些植物集中在毛茛目(Ranunculales)

2. 分类时应该把BIA植物单独列出
   - 不要和其他植物混在一起
   - 因为这是我们benchmark的重点关注对象

3. 判断BIA植物的方法
   - 检查lineage是否包含"Ranunculales"
   - 或者检查是否属于罂粟科、毛茛科、小檗科等
```

### 4.4 最终确定的7个分类

综合两个AI的建议，我们确定了以下分类方案：

| 类别 | 英文标签 | 判断规则 | 说明 |
|------|----------|----------|------|
| 细菌 | Bacteria | lineage含"Bacteria" | 原核生物，结构简单 |
| 古菌 | Archaea | lineage含"Archaea" | 极端环境生物 |
| 真菌 | Fungi | lineage含"Fungi" | 酵母、霉菌等 |
| 哺乳动物 | Mammals | lineage含"Mammalia" | 人、小鼠、大鼠等 |
| 其他动物 | Other_Animals | lineage含"Metazoa"但不含"Mammalia" | 昆虫、鱼类等 |
| **BIA生产植物** | **Plants_BIA** | lineage含"Ranunculales" | **罂粟、黄连等，重点关注！** |
| 其他植物 | Plants_Other | lineage含"Viridiplantae"但不含"Ranunculales" | 拟南芥、水稻等 |

---

## 五、程序是怎么运行的？

### 5.1 整体流程

```
程序执行流程（6个步骤）：

[步骤1] 读取P450酶列表
         │
         │ 读取 P450酶列表_最终版389个.csv
         │ 提取所有uniprot_id（共389个）
         ▼
[步骤2] 查询UniProt获取物种信息
         │
         │ 每批100个ID，向UniProt API发送请求
         │ 获取每个酶的：物种名、物种ID、分类谱系
         ▼
[步骤3] 根据谱系进行分类
         │
         │ 分析每个酶的lineage字符串
         │ 判断属于7个类别中的哪一个
         ▼
[步骤4] 生成分类结果表
         │
         │ 创建包含所有信息的CSV文件
         ▼
[步骤5] 计算统计数据
         │
         │ 统计每个类别的数量和占比
         ▼
[步骤6] 保存结果文件
         │
         │ 保存完整表、汇总表、各类别分表
         ▼
        完成！
```

### 5.2 步骤1详解：读取P450酶列表

```python
# 代码做的事情：
df = pd.read_csv("P450酶列表_最终版389个.csv")  # 读取CSV文件
uniprot_ids = df["uniprot_id"].tolist()        # 提取所有ID到一个列表

# 结果：得到一个列表
# ['P05177', 'Q9NYL5', 'P10635', 'O15528', ...]  共389个
```

### 5.3 步骤2详解：查询UniProt

```
批量查询过程：

第1批：ID 1-100
    │
    │  发送请求到 UniProt API
    │  请求内容：查询 P05177, Q9NYL5, ... 共100个ID的物种信息
    │
    │  收到响应（TSV格式的文本）：
    │  ┌─────────────────────────────────────────────────────────────┐
    │  │ Entry   Organism           Organism ID  Taxonomic lineage   │
    │  │ P05177  Homo sapiens       9606         Eukaryota,Metazoa...│
    │  │ Q9NYL5  Homo sapiens       9606         Eukaryota,Metazoa...│
    │  │ ...                                                         │
    │  └─────────────────────────────────────────────────────────────┘
    │
    └── 等待0.5秒（避免请求太频繁被服务器拒绝）

第2批：ID 101-200
    │
    └── 同样的过程...

第3批：ID 201-300
    │
    └── 同样的过程...

第4批：ID 301-389
    │
    └── 最后89个ID

总共发送4次请求，获取389个酶的物种信息
```

### 5.4 步骤3详解：分类判断

这是最核心的步骤。对于每个酶，程序会分析它的`lineage`（分类谱系）字符串。

**真实例子1：人类P450**

```
UniProt ID: P05177
物种名称: Homo sapiens (智人/人类)
分类谱系: "Eukaryota, Metazoa, Chordata, Craniata, Vertebrata,
          Euteleostomi, Mammalia, Eutheria, Euarchontoglires,
          Primates, Haplorrhini, Catarrhini, Hominidae, Homo"

程序判断过程：
├── lineage包含"Bacteria"吗？ → 否
├── lineage包含"Archaea"吗？ → 否
├── lineage包含"Fungi"吗？ → 否
├── lineage包含"Viridiplantae"吗？ → 否（不是植物）
├── lineage包含"Metazoa"吗？ → 是！（是动物）
│   └── lineage包含"Mammalia"吗？ → 是！（是哺乳动物）
│       └── 物种名是"Homo sapiens"吗？ → 是！
│
└── 结论：类别 = Mammals（哺乳动物），子类别 = Human（人类）
```

**真实例子2：罂粟P450**

```
UniProt ID: P10635
物种名称: Papaver somniferum (鸦片罂粟)
分类谱系: "Eukaryota, Viridiplantae, Streptophyta, Embryophyta,
          Tracheophyta, Spermatophyta, Magnoliopsida,
          Ranunculales, Papaveraceae, Papaver"

程序判断过程：
├── lineage包含"Bacteria"吗？ → 否
├── lineage包含"Archaea"吗？ → 否
├── lineage包含"Fungi"吗？ → 否
├── lineage包含"Viridiplantae"吗？ → 是！（是植物）
│   └── lineage包含"Ranunculales"吗？ → 是！（是毛茛目）
│
└── 结论：类别 = Plants_BIA，子类别 = Ranunculales/BIA-producing
         is_bia_related = True（与BIA相关）
```

**真实例子3：拟南芥P450**

```
UniProt ID: Q9C5R8
物种名称: Arabidopsis thaliana (拟南芥)
分类谱系: "Eukaryota, Viridiplantae, Streptophyta, Embryophyta,
          Tracheophyta, Spermatophyta, Magnoliopsida,
          Brassicales, Brassicaceae, Arabidopsis"

程序判断过程：
├── lineage包含"Viridiplantae"吗？ → 是！（是植物）
│   └── lineage包含"Ranunculales"吗？ → 否（不是毛茛目，是Brassicales十字花目）
│
└── 结论：类别 = Plants_Other（其他植物），is_bia_related = False
```

### 5.5 分类判断的代码逻辑

```python
def classify_by_lineage(lineage, organism_name):
    """
    输入：lineage（分类谱系字符串）, organism_name（物种名）
    输出：(类别, 子类别, 是否与BIA相关)
    """

    # 转小写，方便匹配
    lineage_lower = lineage.lower()

    # 按优先级依次检查

    # 1. 是细菌吗？
    if "bacteria" in lineage_lower:
        return ("Bacteria", "Bacteria", False)

    # 2. 是古菌吗？
    if "archaea" in lineage_lower:
        return ("Archaea", "Archaea", False)

    # 3. 是真菌吗？
    if "fungi" in lineage_lower:
        return ("Fungi", "Fungi", False)

    # 4. 是植物吗？
    if "viridiplantae" in lineage_lower:
        # 进一步检查是否是BIA生产植物
        if "ranunculales" in lineage_lower:  # 毛茛目
            return ("Plants_BIA", "Ranunculales/BIA-producing", True)
        else:
            return ("Plants_Other", "Other plants", False)

    # 5. 是动物吗？
    if "metazoa" in lineage_lower:
        if "mammalia" in lineage_lower:  # 哺乳动物
            return ("Mammals", "Mammalia", False)
        else:  # 其他动物
            return ("Other_Animals", "Other animals", False)

    # 6. 都不是，归为未知
    return ("Unknown", "Unknown", False)
```

---

## 六、如何判断一个酶属于哪个类别？

### 6.1 判断流程图

```
                    开始
                      │
                      ▼
              ┌───────────────┐
              │ 读取lineage   │
              │ （分类谱系）   │
              └───────┬───────┘
                      │
                      ▼
              ┌───────────────┐
         ┌────│ 含"Bacteria"?│
         │    └───────┬───────┘
         │ 是         │ 否
         ▼            ▼
    ┌────────┐  ┌───────────────┐
    │ 细菌   │  │ 含"Fungi"?    │
    └────────┘  └───────┬───────┘
                   │ 是     │ 否
                   ▼        ▼
              ┌────────┐  ┌─────────────────┐
              │ 真菌   │  │ 含"Viridiplantae"?│
              └────────┘  └───────┬─────────┘
                              │ 是     │ 否
                              ▼        ▼
                    ┌─────────────┐  ┌──────────────┐
                    │含"Ranunculales"?│  │ 含"Metazoa"? │
                    └───────┬─────┘  └──────┬───────┘
                       │ 是  │ 否        │ 是  │ 否
                       ▼     ▼           ▼     ▼
                 ┌────────┐┌────────┐┌──────────┐┌────────┐
                 │BIA植物 ││其他植物││继续判断  ││ 未知   │
                 └────────┘└────────┘│哺乳动物? │└────────┘
                                     └────┬─────┘
                                      │ 是  │ 否
                                      ▼     ▼
                                ┌────────┐┌────────┐
                                │哺乳动物││其他动物│
                                └────────┘└────────┘
```

### 6.2 关键判断词汇表

| 判断词 | 含义 | 对应类别 |
|--------|------|----------|
| Bacteria | 细菌域 | Bacteria |
| Archaea | 古菌域 | Archaea |
| Fungi | 真菌界 | Fungi |
| Viridiplantae | 绿色植物界 | Plants_BIA 或 Plants_Other |
| Ranunculales | 毛茛目 | Plants_BIA（重点！） |
| Metazoa | 后生动物界（多细胞动物） | Mammals 或 Other_Animals |
| Mammalia | 哺乳纲 | Mammals |

### 6.3 为什么用"Ranunculales"判断BIA植物？

```
BIA（苄基异喹啉生物碱）生产植物的分布：

毛茛目 (Ranunculales)
    │
    ├── 罂粟科 (Papaveraceae)
    │       ├── 罂粟属 (Papaver) → 鸦片罂粟、虞美人
    │       ├── 加州罂粟属 (Eschscholzia) → 加州罂粟
    │       └── 白屈菜属 (Chelidonium) → 白屈菜
    │
    ├── 毛茛科 (Ranunculaceae)
    │       └── 黄连属 (Coptis) → 黄连
    │
    └── 小檗科 (Berberidaceae)
            ├── 小檗属 (Berberis) → 小檗
            └── 鬼臼属 (Podophyllum, Sinopodophyllum) → 鬼臼

所有这些植物的lineage中都包含"Ranunculales"！
所以只需检查这一个词就能识别出所有BIA生产植物。
```

---

## 七、输出了什么结果？

### 7.1 输出文件列表

| 文件名 | 内容 | 用途 |
|--------|------|------|
| P450物种分类_完整版389个.csv | 所有389个P450的完整分类数据 | 详细查询 |
| P450物种分类_汇总.csv | 按类别汇总的统计表 | 快速了解分布 |
| 分类统计.json | JSON格式的统计数据 | 程序处理 |
| P450_BIA生产植物_25个.csv | 25个BIA相关P450 | **重点关注！** |
| P450_哺乳动物_87个.csv | 87个哺乳动物P450 | 分类查看 |
| P450_其他植物_217个.csv | 217个其他植物P450 | 分类查看 |
| P450_其他动物_25个.csv | 25个其他动物P450 | 分类查看 |
| P450_细菌_18个.csv | 18个细菌P450 | 分类查看 |
| P450_真菌_15个.csv | 15个真菌P450 | 分类查看 |
| P450_未知_2个.csv | 2个未知类别P450 | 需人工检查 |

### 7.2 完整版CSV的字段说明

文件：`P450物种分类_完整版389个.csv`

| 字段名 | 说明 | 示例 |
|--------|------|------|
| uniprot_id | UniProt唯一标识符 | P05177 |
| organism_name | 物种名称（拉丁名+常用名） | Homo sapiens |
| organism_id | NCBI Taxonomy ID（物种编号） | 9606 |
| lineage | 完整分类谱系 | Eukaryota, Metazoa, ... |
| category | 分类类别（7类之一） | Mammals |
| subcategory | 子类别 | Human |
| is_bia_related | 是否与BIA相关 | False |

### 7.3 25个BIA相关P450详情

这是我们最关心的结果。以下是25个来自BIA生产植物的P450：

| # | UniProt ID | 物种 | 中文名 |
|---|------------|------|--------|
| 1-2 | A0A0N7F297, A0A0N9HTU1 | Sinopodophyllum hexandrum | 桃儿七/喜马拉雅鬼臼 |
| 3 | A0A0P0YJU0 | Delphinium semibarbatum | 翠雀属 |
| 4-6 | A0A1W6S9Y7, A0A240FWB3, A0A240FWB4 | Chelidonium majus | 白屈菜 |
| 7 | A8CDR5 | Coptis japonica | 日本黄连 |
| 8 | B1NF18 | Papaver somniferum | 鸦片罂粟 |
| 9 | B1NF19 | Argemone mexicana | 墨西哥蓟罂粟 |
| 10 | B2BF50 | Coptis chinensis | 黄连 |
| 11-13 | B5UAQ8, F2Z9C1, O64900, Q50LH4 | Eschscholzia californica | 加州罂粟 |
| 14-20 | I3PLR0, I3PLR1, I3QBP4, I3V6B7, L7X0L7, P0DKI7, Q9SP06 | Papaver somniferum | 鸦片罂粟 |
| 21 | L7T720 | Podophyllum peltatum | 北美鬼臼 |
| 22 | L7T8H2 | Sinopodophyllum hexandrum | 桃儿七 |
| 23 | P47195 | Berberis stolonifera | 小檗 |
| 24 | Q52YL8 | Delphinium grandiflorum | 大花翠雀 |

---

## 八、关键发现是什么？

### 8.1 分类结果统计

```
╔══════════════════════════════════════════════════════════╗
║              P450物种分类结果（389个）                    ║
╠══════════════════╦═══════════╦═══════════════════════════╣
║ 类别             ║ 数量      ║ 占比                      ║
╠══════════════════╬═══════════╬═══════════════════════════╣
║ 其他植物         ║ 217       ║ 55.8%                     ║
║ 哺乳动物         ║ 87        ║ 22.4%                     ║
║ BIA生产植物      ║ 25        ║ 6.4%  ← 重要发现！        ║
║ 其他动物         ║ 25        ║ 6.4%                      ║
║ 细菌             ║ 18        ║ 4.6%                      ║
║ 真菌             ║ 15        ║ 3.9%                      ║
║ 未知             ║ 2         ║ 0.5%                      ║
╚══════════════════╩═══════════╩═══════════════════════════╝
```

### 8.2 重要发现

**发现：EZSpecificity的训练数据中已经包含25个来自BIA生产植物的P450酶！**

这意味着：
1. 训练数据并非完全不包含BIA相关P450
2. 如果你要benchmark的目标P450恰好是这25个之一，则benchmark不公平
3. 需要检查这25个酶的具体CYP家族（如CYP80、CYP719等）

### 8.3 Benchmark建议

| 情况 | 建议 |
|------|------|
| 目标P450在这25个列表中 | **不应用于benchmark**（模型已见过） |
| 目标P450不在这25个列表中 | **可安全用于benchmark** |
| 目标P450来自其他BIA植物（如未在训练中出现的黄连品种） | **需谨慎评估**，检查序列相似性 |

### 8.4 后续工作建议

1. **检查CYP家族**：确认这25个P450属于哪些CYP家族
2. **序列相似性分析**：与目标P450进行序列比对
3. **底物特异性分析**：查看这25个P450在训练数据中对应的底物

---

## 附录：术语表

| 术语 | 解释 |
|------|------|
| UniProt | 全球最大的蛋白质序列和功能数据库 |
| API | 应用程序编程接口，用于不同程序之间的通信 |
| lineage | 分类谱系，表示一个生物从大类到小类的完整分类路径 |
| Ranunculales | 毛茛目，一个植物分类单元，包含罂粟科、毛茛科等 |
| BIA | 苄基异喹啉生物碱，一类重要的植物天然产物 |
| P450 / CYP | 细胞色素P450酶，一类重要的氧化酶 |
| benchmark | 基准测试，用于评估模型性能的测试方法 |

---

## 九、文件夹结构说明

### 9.1 整理后的目录结构

为了便于管理和查找，本文件夹的24个文件已被整理为以下结构：

```
2026-01-03_03-10_P450物种分类/
│
├── P450物种分类报告.md          # 分类结果简要报告
├── 分类方法详解_零基础版.md      # 本文档（详细方法说明）
│
├── 数据文件/                    # 所有CSV数据文件
│   ├── 原始分类数据/            # 第一步：物种分类结果
│   │   ├── P450物种分类_完整版389个.csv   # 所有389个P450的分类
│   │   ├── P450物种分类_汇总.csv           # 按类别汇总统计
│   │   ├── P450_BIA生产植物_25个.csv      # 25个BIA相关P450
│   │   ├── P450_哺乳动物_87个.csv          # 87个哺乳动物P450
│   │   ├── P450_其他植物_217个.csv         # 217个其他植物P450
│   │   ├── P450_其他动物_25个.csv          # 25个其他动物P450
│   │   ├── P450_细菌_18个.csv              # 18个细菌P450
│   │   ├── P450_真菌_15个.csv              # 15个真菌P450
│   │   └── P450_未知_2个.csv               # 2个未知类别P450
│   │
│   └── 含底物数据/              # 第二步：整合底物反应数据
│       ├── P450_物种分类_含底物数据_完整版.csv  # 389个P450+底物数据
│       ├── P450_BIA生产植物_25个_含底物数据.csv
│       ├── P450_哺乳动物_87个_含底物数据.csv
│       ├── P450_其他植物_217个_含底物数据.csv
│       ├── P450_其他动物_25个_含底物数据.csv
│       ├── P450_细菌_18个_含底物数据.csv
│       ├── P450_真菌_15个_含底物数据.csv
│       └── P450_未知_2个_含底物数据.csv
│
├── 脚本/                        # Python脚本
│   ├── P450物种分类脚本.py      # 执行物种分类的脚本
│   └── 整合物种分类与底物数据.py # 整合底物数据的脚本
│
└── 统计数据/                    # 统计结果
    ├── 分类统计.json            # 分类结果的JSON格式统计
    ├── 物种分类_底物统计.json   # 含底物数据的JSON格式统计
    └── 物种分类_底物统计汇总.csv # 底物数据汇总表
```

### 9.2 两步数据处理流程

```
第一步：物种分类
┌──────────────────┐     ┌────────────────────────────┐
│ P450酶列表       │ ──→ │ 查询UniProt获取物种信息    │
│ (389个UniProt ID)│     │ 按lineage分类到7个类别     │
└──────────────────┘     └────────────────────────────┘
                                      │
                                      ▼
                         ┌────────────────────────────┐
                         │ 原始分类数据/              │
                         │ (9个CSV文件)               │
                         └────────────────────────────┘

第二步：整合底物数据
┌──────────────────┐     ┌────────────────────────────┐
│ 原始分类数据     │ ──→ │ 关联底物反应数据           │
│ (含物种信息)     │     │ (来自ESIBank data.csv)     │
└──────────────────┘     └────────────────────────────┘
                                      │
                                      ▼
                         ┌────────────────────────────┐
                         │ 含底物数据/                │
                         │ (8个CSV文件)               │
                         └────────────────────────────┘
```

---

## 十、数据文件列含义详解

### 10.1 原始分类数据文件的列

文件示例：`数据文件/原始分类数据/P450物种分类_完整版389个.csv`

| 列名 | 英文含义 | 中文说明 | 示例值 |
|------|----------|----------|--------|
| `uniprot_id` | UniProt ID | 酶的唯一标识符 | P05177, Q9NYL5 |
| `organism_name` | Organism Name | 物种名称（拉丁名+常用名） | Homo sapiens (Human) |
| `organism_id` | Organism ID | NCBI物种编号 | 9606（人类）, 3469（罂粟） |
| `lineage` | Taxonomic Lineage | 完整分类谱系 | Eukaryota, Metazoa, ... |
| `category` | Category | 分类类别（7类之一） | Mammals, Plants_BIA |
| `subcategory` | Subcategory | 子类别/详细分类 | Human, Ranunculales/BIA-producing |
| `is_bia_related` | Is BIA Related | 是否与BIA相关 | True / False |

#### 示例解读

```csv
uniprot_id,organism_name,organism_id,lineage,category,subcategory,is_bia_related
P05177,Homo sapiens (Human),9606,"Eukaryota, Metazoa, Mammalia, ...",Mammals,Human,False
B1NF18,Papaver somniferum (Opium poppy),3469,"Eukaryota, Viridiplantae, Ranunculales, ...",Plants_BIA,Ranunculales/BIA-producing,True
```

**解读**：
- `P05177` 是一个人类P450酶，属于哺乳动物（Mammals），不与BIA相关
- `B1NF18` 来自鸦片罂粟，属于BIA生产植物（Plants_BIA），与BIA相关

---

### 10.2 含底物数据文件的列

文件示例：`数据文件/含底物数据/P450_BIA生产植物_25个_含底物数据.csv`

| 列名 | 英文含义 | 中文说明 | 示例值 |
|------|----------|----------|--------|
| `uniprot_id` | UniProt ID | 酶的唯一标识符 | B1NF18 |
| `organism_name` | Organism Name | 物种名称 | Papaver somniferum |
| `organism_id` | Organism ID | NCBI物种编号 | 3469 |
| `lineage` | Taxonomic Lineage | 分类谱系 | Eukaryota, Viridiplantae, ... |
| `category` | Category | 分类类别 | Plants_BIA |
| `subcategory` | Subcategory | 子类别 | Ranunculales/BIA-producing |
| `is_bia_related` | Is BIA Related | 是否与BIA相关 | True |
| `positive_substrate_count` | Positive Substrate Count | **正样本底物数量** | 3 |
| `negative_substrate_count` | Negative Substrate Count | **负样本底物数量** | 25 |
| `total_pairs` | Total Pairs | **总配对数量** | 28 |
| `positive_substrates` | Positive Substrates | 正样本底物列表 | SMILES字符串，分号分隔 |
| `negative_substrates` | Negative Substrates | 负样本底物列表 | SMILES字符串，分号分隔 |

#### 什么是正样本/负样本？

```
正样本 (Positive, label=1)：
├── 定义：该酶确实能催化该底物的反应
├── 来源：BRENDA数据库的实验验证数据
└── 示例：CYP79A1 + L-酪氨酸 → 已知的酶-底物对

负样本 (Negative, label=0)：
├── 定义：该酶（可能）不能催化该底物
├── 来源：根据EC号相似性生成的"硬负样本"
└── 示例：CYP79A1 + 随机底物 → 模型需要学会区分的假配对
```

#### 示例解读

假设某个P450酶的记录如下：
```
uniprot_id: B1NF18
organism_name: Papaver somniferum (Opium poppy)
category: Plants_BIA
positive_substrate_count: 3
negative_substrate_count: 25
total_pairs: 28
positive_substrates: CC(=O)Oc1ccc(C[C@@H]2...); ...（3个SMILES）
negative_substrates: CC(C)CC1=CC=C(C=C1)...（25个SMILES）
```

**解读**：
- 这个鸦片罂粟P450酶（B1NF18）在训练数据中有28个酶-底物配对
- 其中3个是正样本（真实酶-底物对），25个是负样本（用于训练模型区分能力）
- 底物以SMILES格式表示（一种分子结构的字符串编码）

---

### 10.3 汇总统计文件的列

文件：`统计数据/物种分类_底物统计汇总.csv`

| 列名 | 中文说明 | 示例值 |
|------|----------|--------|
| `category` | 类别英文名 | Plants_BIA |
| `category_cn` | 类别中文名 | BIA生产植物 |
| `enzyme_count` | 该类别P450酶总数 | 25 |
| `with_substrate_data` | 有底物数据的酶数 | 25 |
| `without_substrate_data` | 无底物数据的酶数 | 0 |
| `total_positive_pairs` | 正样本配对总数 | 42 |
| `total_negative_pairs` | 负样本配对总数 | 548 |
| `total_pairs` | 总配对数 | 590 |

#### 汇总表数据一览

```
╔══════════════════╦═════════════╦════════════════╦═════════════╦═════════════╗
║ 类别             ║ P450酶数    ║ 有底物数据     ║ 正样本对    ║ 负样本对    ║
╠══════════════════╬═════════════╬════════════════╬═════════════╬═════════════╣
║ 其他植物         ║ 217         ║ 212            ║ 477         ║ 5,753       ║
║ 哺乳动物         ║ 87          ║ 83             ║ 261         ║ 3,776       ║
║ BIA生产植物      ║ 25          ║ 25             ║ 42          ║ 548         ║
║ 其他动物         ║ 25          ║ 20             ║ 32          ║ 458         ║
║ 细菌             ║ 18          ║ 12             ║ 30          ║ 423         ║
║ 真菌             ║ 15          ║ 13             ║ 37          ║ 436         ║
║ 未知             ║ 2           ║ 2              ║ 5           ║ 51          ║
╠══════════════════╬═════════════╬════════════════╬═════════════╬═════════════╣
║ **合计**         ║ **389**     ║ **367**        ║ **884**     ║ **11,445**  ║
╚══════════════════╩═════════════╩════════════════╩═════════════╩═════════════╝
```

---

## 附录：术语表

| 术语 | 解释 |
|------|------|
| UniProt | 全球最大的蛋白质序列和功能数据库 |
| API | 应用程序编程接口，用于不同程序之间的通信 |
| lineage | 分类谱系，表示一个生物从大类到小类的完整分类路径 |
| Ranunculales | 毛茛目，一个植物分类单元，包含罂粟科、毛茛科等 |
| BIA | 苄基异喹啉生物碱，一类重要的植物天然产物 |
| P450 / CYP | 细胞色素P450酶，一类重要的氧化酶 |
| benchmark | 基准测试，用于评估模型性能的测试方法 |
| SMILES | 简化分子线性输入规范，用字符串表示分子结构 |
| 正样本 | 真实的酶-底物配对（酶确实能催化该底物） |
| 负样本 | 假设的非配对（酶可能不能催化该底物），用于模型训练 |

---

**文档生成时间**：2026-01-03
**最后更新**：2026-01-03 04:10
**作者**：Claude Code（三方协作：Claude + Codex + Gemini）
