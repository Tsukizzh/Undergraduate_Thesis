# EZSpecificity 仓库结构总览

## 扫描时间
2025-12-31

> **⚠️ 注意**：本文件为初步探索阶段的记录。P450酶的精确统计数据请参考：
> - [P450识别报告.md](../2025-12-31_02-20_P450识别结果/P450识别报告.md)
> - 最终统计：训练集含 **4,135个独特P450酶**（4,121来自brenda + 14来自halogenase）

---

## 一、代码仓库结构

**路径**: `C:\Users\Administrator\Desktop\EZSpecificity_Project`

```
EZSpecificity_Project/
├── data/                          # 数据文件夹
│   ├── pretrain_model/
│   │   └── grover_large.pt        # GROVER预训练模型 (428MB)
│   └── toy_example/               # 示例数据（用于测试）
│       ├── data.csv               # 酶-底物对索引
│       ├── Enzymes.csv            # 酶序列和ID
│       ├── Substrates.csv         # 底物信息
│       ├── testing_datas.csv      # 测试数据
│       └── Structure/
│           └── complex.tar.gz     # 3D复合物结构 (60MB)
│
├── src/                           # 源代码
│   ├── Datasets/                  # 数据处理模块
│   │   ├── brenda.py              # BRENDA数据处理
│   │   ├── const.py               # 常量定义
│   │   ├── create_features.py     # 特征创建
│   │   ├── data_representer.py    # 数据表示
│   │   ├── utils.py               # 工具函数
│   │   ├── preprocess.ipynb       # 预处理notebook
│   │   ├── preprocess_full_brenda.ipynb  # BRENDA完整预处理
│   │   └── Structure/             # 结构相关处理
│   │       ├── collator.py
│   │       ├── protein_ligand.py
│   │       ├── structure.py
│   │       ├── transforms.py
│   │       └── utils.py
│   │
│   ├── Models/                    # 模型定义
│   │   ├── common.py              # 通用组件
│   │   ├── cpi.py                 # CPI模型
│   │   ├── ss.py                  # 主模型（EZSpecificity）
│   │   ├── utils.py
│   │   └── Structure/             # 结构相关模型
│   │       ├── egnn.py            # E(n)-等变GNN
│   │       ├── gnn.py             # 图神经网络
│   │       └── structure.py
│   │
│   ├── other_softwares/           # 第三方软件
│   │   └── grover_software/       # GROVER分子指纹工具
│   │
│   ├── main_testing.py            # 主测试脚本
│   ├── example.ipynb              # 使用示例notebook
│   ├── utils.py                   # 通用工具
│   ├── environment.yml            # conda环境配置
│   └── readme.md                  # 说明文档
│
├── saved_model/                   # 保存的模型
│   └── model/
│       └── run_0/                 # 训练运行0的模型
│
└── 提取P450过程日志/              # 本项目的工作日志
```

---

## 二、ESIBank数据库结构

**路径**: `G:\.shortcut-targets-by-id\173a36NiOLgXcvzvJjRDH29y2xd7Ey3Pr\ESIBank`

```
ESIBank/
├── brenda/                        # ★ 主要BRENDA数据集
│   ├── data.csv                   # 酶-底物对数据 (586,515行)
│   ├── enzymes.csv                # 酶信息 (25,225个酶)
│   ├── raw_data.csv               # 原始数据
│   ├── reaction.csv               # 反应信息
│   ├── reaction_smiles.csv        # 反应SMILES
│   │
│   ├── enzyme_features.lmdb       # 酶特征数据库 (53GB)
│   ├── grover_fingerprint.lmdb    # GROVER指纹 (9.6GB)
│   ├── morgan_fingerprint.npy     # Morgan指纹 (324MB)
│   ├── reaction_features.lmdb     # 反应特征
│   │
│   ├── all_split/                 # ★ 训练/验证/测试划分（4折交叉验证）
│   │   ├── training_datas_0-3.csv
│   │   ├── testing_datas_0-3.csv
│   │   └── val_datas_0-3.csv
│   │
│   ├── enzyme_split/              # 按酶划分
│   ├── random_split/              # 随机划分
│   ├── reaction_split/            # 按反应划分
│   ├── final_data/                # 最终数据
│   └── structure/                 # 3D结构文件
│
└── small_family/                  # ★ 特定酶家族数据
    ├── 2023_brenda/               # 2023年BRENDA数据
    ├── Duf/                       # 功能未知蛋白 (DUFs)
    ├── Esterase/                  # 酯酶
    ├── Gt_acceptor/               # 糖基转移酶
    ├── halogenase/                # ★ 卤化酶（论文实验验证）
    ├── Nitrilase/                 # 腈水解酶
    ├── Phosphatase/               # 磷酸酶
    ├── Thiolase/                  # 硫解酶
    └── experiment/                # 实验数据
```

---

## 三、关键数据文件说明

### 3.1 enzymes.csv 结构
| 列名 | 含义 | 示例 |
|------|------|------|
| sequences | 蛋白质氨基酸序列 | MSTAGKVIKCKAAVLWELKK... |
| uniprots | UniProt ID | P07327, P00329, Q938F2 |

### 3.2 data.csv 结构
| 列名 | 含义 | 示例 |
|------|------|------|
| enzyme | 酶索引（对应enzymes.csv行号） | 15164 |
| reaction | 反应索引 | 33122 |
| label | 标签（0=负样本，1=正样本） | 0, 1 |
| ecnumber | EC号（酶分类号） | 3.5.2.6, 1.14.14.1 |
| difficulty | 难度等级 | 0, 1, 2, 3, 4 |
| fake_ecnumber | 负样本对应的假EC号 | 3.2.1.3 |
| structure_index | 3D结构索引 | 203913, -1(无结构) |

---

## 四、数据量统计

### 4.1 BRENDA主数据集
| 指标 | 数量 |
|------|------|
| 酶总数 | 25,225 |
| 酶-底物对总数 | 586,515 |

### 4.2 训练/验证/测试划分（4折交叉验证）
| 数据集 | Fold 0 | Fold 1 | Fold 2 | Fold 3 |
|--------|--------|--------|--------|--------|
| 训练集 | ~12.9MB | ~12.4MB | ~12.3MB | ~12.4MB |
| 验证集 | ~109KB | ~149KB | ~116KB | ~124KB |
| 测试集 | ~621KB | ~641KB | ~756KB | ~709KB |

---

## 五、P450相关数据初步发现

### 5.1 P450 EC号分布（前10）
| EC号 | 数据条数 | 说明 |
|------|---------|------|
| 1.14.14.1 | 871 | 通用P450单加氧酶 |
| 1.14.14.82 | 709 | - |
| 1.14.14.11 | 608 | - |
| 1.14.15.16 | 544 | - |
| 1.14.14.9 | 527 | - |
| 1.14.14.32 | 507 | - |
| 1.14.14.137 | 454 | - |
| 1.14.14.91 | 450 | - |
| 1.14.14.154 | 428 | - |
| 1.14.14.126 | 407 | - |

### 5.2 初步结论
- **ESIBank中确实包含P450酶数据**
- P450相关EC号（1.14.14.* 和 1.14.15.*）的数据约有 **23,966条**
- 需要进一步分析具体有多少个独特的P450酶

---

## 六、后续分析方向

1. 统计P450酶的具体数量（唯一的enzyme索引）
2. 获取P450酶的UniProt ID列表
3. 分析P450酶在训练/验证/测试集中的分布
4. 验证这些酶是否真的是P450（通过UniProt查询）
