# CLAUDE.md

æœ¬æ–‡ä»¶ä¸º Claude Code (claude.ai/code) åœ¨æ­¤ä»£ç åº“ä¸­å·¥ä½œæ—¶æä¾›æŒ‡å¯¼ã€‚

## é¡¹ç›®æ¦‚è¿°

EZSpecificity æ˜¯ä¸€ä¸ªåŸºäºäº¤å‰æ³¨æ„åŠ›æœºåˆ¶çš„ SE(3)-ç­‰å˜å›¾ç¥ç»ç½‘ç»œï¼Œç”¨äºé¢„æµ‹é…¶-åº•ç‰©ç‰¹å¼‚æ€§ã€‚å®ƒåŸºäºä»¥ä¸‹ç‰¹å¾é¢„æµ‹ç»™å®šé…¶æ˜¯å¦èƒ½å‚¬åŒ–ç‰¹å®šåº•ç‰©çš„ååº”ï¼š
- è›‹ç™½è´¨åºåˆ—åµŒå…¥ï¼ˆESMï¼‰
- åˆ†å­æŒ‡çº¹ï¼ˆMorganã€GROVERï¼‰
- é…¶-åº•ç‰©å¯¹æ¥å¤åˆç‰©çš„ 3D ç»“æ„ç‰¹å¾

**Web ç•Œé¢**ï¼šhttps://ezspecificity.platform.moleculemaker.org/home

**ä¸»è¦å·¥ä½œæµç¨‹**ï¼šæœ¬é¡¹ç›®ä¸“æ³¨äºæ¨ç†ï¼ˆinferenceï¼‰ã€‚ä½¿ç”¨ `src/example.ipynb` è·å–å®Œæ•´çš„ç«¯åˆ°ç«¯æµç¨‹ã€‚

## å¿«é€Ÿå¼€å§‹

```bash
# 1. åˆ›å»ºç¯å¢ƒ
conda env create -f src/environment.yml
conda activate ezspecificity

# 2. å®‰è£… PyTorch Geometricï¼ˆæ¿€æ´» conda ç¯å¢ƒåï¼‰
pip install torch_geometric
pip install pyg_lib torch_scatter torch_sparse torch_cluster torch_spline_conv -f https://data.pyg.org/whl/torch-2.1.0+cu121.html

# 3. è¿è¡Œç¤ºä¾‹
cd src
jupyter notebook example.ipynb
```

## ç³»ç»Ÿè¦æ±‚

**æµ‹è¯•ç¯å¢ƒ**ï¼š
- æ“ä½œç³»ç»Ÿï¼šUbuntu 22.04ï¼ˆä¸»è¦ï¼‰ã€Windows 10/11ï¼ˆéœ€è°ƒæ•´ï¼‰
- Pythonï¼š3.10.12
- CUDAï¼š12.1
- GPUï¼šæ¨è NVIDIA GPU â‰¥8GB æ˜¾å­˜
- ç£ç›˜ï¼šâ‰¥20GB å¯ç”¨ç©ºé—´ç”¨äºæ¨¡å‹å’Œç‰¹å¾

**Windows æ³¨æ„äº‹é¡¹**ï¼š
- è·¯å¾„ä½¿ç”¨åæ–œæ  `\` æˆ–åŸå§‹å­—ç¬¦ä¸²
- æŸäº› shell å‘½ä»¤å¯èƒ½éœ€è¦ PowerShell/CMD ç­‰æ•ˆå‘½ä»¤
- GROVER PYTHONPATH è®¾ç½®ï¼š`set PYTHONPATH=<project_root>\src\other_softwares\grover_software;%PYTHONPATH%`

## å¸¸ç”¨å‘½ä»¤

### ç¯å¢ƒè®¾ç½®

```bash
# åˆ›å»º conda ç¯å¢ƒ
conda env create -f src/environment.yml
conda activate ezspecificity

# å®‰è£… PyTorch Geometricï¼ˆæ¿€æ´» conda ç¯å¢ƒåï¼‰
pip install torch_geometric
pip install pyg_lib torch_scatter torch_sparse torch_cluster torch_spline_conv -f https://data.pyg.org/whl/torch-2.1.0+cu121.html
```

**æ³¨æ„**ï¼šPyTorch Geometric åŒ…ç‰ˆæœ¬å¿…é¡»ä¸æ‚¨çš„ CUDA ç‰ˆæœ¬åŒ¹é…ã€‚å¯¹äº CUDA 12.1ï¼Œä½¿ç”¨ä¸Šè¿° URLã€‚å¯¹äºå…¶ä»– CUDA ç‰ˆæœ¬ï¼Œè¯·æŸ¥çœ‹ https://pytorch-geometric.readthedocs.io/en/latest/install/installation.html

### è¿è¡Œæ¨ç†

```bash
# ä¸»è¦æ–¹æ³•ï¼šJupyter notebookï¼ˆæ¨èç”¨äºäº¤äº’å¼æ¢ç´¢ï¼‰
cd src
jupyter notebook example.ipynb

# æ›¿ä»£æ–¹æ³•ï¼šPython è„šæœ¬ï¼ˆå¦‚æœåœ¨ Jupyter ä¸­é‡åˆ° DDP ç­–ç•¥é”™è¯¯ï¼Œè¯·ä½¿ç”¨æ­¤æ–¹æ³•ï¼‰
cd src
python main_testing.py
```

### GROVER ç‰¹å¾ç”Ÿæˆ

GROVER ç”Ÿæˆåˆ†å­æŒ‡çº¹ï¼Œéœ€è¦å¤šæ­¥éª¤æµç¨‹ï¼š

```bash
# å¯¼èˆªåˆ° GROVER ç›®å½•
cd src/other_softwares/grover_software

# è®¾ç½® PYTHONPATHï¼ˆLinux/Macï¼‰
export PYTHONPATH=<project_root>/src/other_softwares/grover_software:$PYTHONPATH

# è®¾ç½® PYTHONPATHï¼ˆWindowsï¼‰
set PYTHONPATH=<project_root>\src\other_softwares\grover_software;%PYTHONPATH%

# æ­¥éª¤ 1ï¼šç”Ÿæˆç‰¹å¾
python scripts/save_features.py --data_path <input.csv> --save_path <output.npz> --features_generator fgtasklabel --restart

# æ­¥éª¤ 2ï¼šæ„å»ºè¯æ±‡è¡¨
python scripts/build_vocab.py --data_path <input.csv> --vocab_save_folder <vocab_dir> --dataset_name test

# æ­¥éª¤ 3ï¼šç”ŸæˆæŒ‡çº¹
python main.py fingerprint --data_path <input.csv> --features_path <features.npz> --checkpoint_path <grover_large.pt> --fingerprint_source both --output <output.npz> --save_lmdb_path <output.lmdb>
```

**é‡è¦**ï¼šGROVER æ£€æŸ¥ç‚¹ `grover_large.pt` åº”ä½äº `data/pretrain_model/grover_large.pt`ã€‚å¦‚æœç¼ºå¤±ï¼Œè¯·ä»åŸå§‹ GROVER ä»“åº“ä¸‹è½½ã€‚

### éªŒè¯æ­¥éª¤

å®‰è£…åï¼ŒéªŒè¯æ‚¨çš„è®¾ç½®ï¼š

```bash
# 1. æ£€æŸ¥ conda ç¯å¢ƒ
conda activate ezspecificity
python -c "import torch; print(f'PyTorch: {torch.__version__}, CUDA: {torch.cuda.is_available()}')"

# 2. æ£€æŸ¥ PyTorch Geometric
python -c "import torch_geometric; print(f'PyG: {torch_geometric.__version__}')"

# 3. æ£€æŸ¥å…³é”®ä¾èµ–é¡¹
python -c "import esm, rdkit, Bio; print('ESM, RDKit, BioPython: OK')"

# 4. éªŒè¯ç¤ºä¾‹æ•°æ®å­˜åœ¨
ls data/toy_example/
# åº”æ˜¾ç¤ºï¼šEnzymes.csv, Substrates.csv, data.csv, Structure/
```

## æ¶æ„

### é¡¹ç›®ç»“æ„æ¦‚è§ˆ

```
EZSpecificity_Project/
â”œâ”€â”€ src/                           # æºä»£ç 
â”‚   â”œâ”€â”€ Models/                    # æ¨¡å‹å®ç°
â”‚   â”‚   â”œâ”€â”€ ss.py                  # ä¸»è¦ SS æ¨¡å‹ï¼ˆäº¤å‰æ³¨æ„åŠ›ï¼‰
â”‚   â”‚   â””â”€â”€ Structure/             # åŸºäºç»“æ„çš„æ¨¡å‹ï¼ˆEGNNï¼‰
â”‚   â”œâ”€â”€ Datasets/                  # æ•°æ®å¤„ç†
â”‚   â”‚   â”œâ”€â”€ brenda.py              # æ•°æ®é›†åŠ è½½å’Œæ‰¹å¤„ç†
â”‚   â”‚   â”œâ”€â”€ create_features.py     # ç‰¹å¾ç”Ÿæˆï¼ˆESMã€å›¾ï¼‰
â”‚   â”‚   â””â”€â”€ Structure/             # ç»“æ„æ•°æ®å¤„ç†
â”‚   â”œâ”€â”€ other_softwares/
â”‚   â”‚   â””â”€â”€ grover_software/       # GROVER åˆ†å­æŒ‡çº¹
â”‚   â”œâ”€â”€ example.ipynb              # å®Œæ•´å·¥ä½œæµç¨‹æ¼”ç¤º
â”‚   â””â”€â”€ main_testing.py            # æ¨ç†è„šæœ¬
â”œâ”€â”€ data/                          # æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ pretrain_model/            # é¢„è®­ç»ƒæƒé‡
â”‚   â”‚   â””â”€â”€ grover_large.pt
â”‚   â””â”€â”€ toy_example/               # ç¤ºä¾‹è¾“å…¥/è¾“å‡º
â””â”€â”€ saved_model/                   # è®­ç»ƒå¥½çš„æ¨¡å‹æ£€æŸ¥ç‚¹
    â””â”€â”€ model/run_0/
        â””â”€â”€ complete-full-random-all-0-complex.yml
```

### æ ¸å¿ƒæ¨¡å‹æµç¨‹

```
è¾“å…¥ï¼šé…¶åºåˆ— + åº•ç‰© SMILES + å¯¹æ¥å¤åˆç‰© PDB
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç‰¹å¾æå–                                                    â”‚
â”‚  â”œâ”€â”€ ESM åµŒå…¥ï¼ˆprotein_mlp â†’ 1280 â†’ hidden_dimï¼‰            â”‚
â”‚  â”œâ”€â”€ GROVER åµŒå…¥ï¼ˆåŸå­çº§ + åˆ†å­çº§ï¼‰                          â”‚
â”‚  â”œâ”€â”€ Morgan æŒ‡çº¹ï¼ˆ1024-bitï¼‰                                â”‚
â”‚  â””â”€â”€ ç»“æ„ç‰¹å¾ï¼ˆå£è¢‹ + é…ä½“åæ ‡ï¼‰                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SE(3)-ç­‰å˜ GNNï¼ˆModels/Structure/egnn.pyï¼‰                 â”‚
â”‚  â””â”€â”€ EnBaseLayer Ã— num_layersï¼ˆå›¾ä¸Šæ¶ˆæ¯ä¼ é€’ï¼‰               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  äº¤å‰æ³¨æ„åŠ›ï¼ˆModels/ss.pyï¼‰                                  â”‚
â”‚  â”œâ”€â”€ enzyme_attentionï¼šé…¶æŸ¥è¯¢åº•ç‰©                            â”‚
â”‚  â””â”€â”€ reaction_attentionï¼šåº•ç‰©æŸ¥è¯¢é…¶                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç‰¹å¼‚æ€§é¢„æµ‹å¤´ï¼ˆMLPï¼‰                                         â”‚
â”‚  â””â”€â”€ èšåˆåµŒå…¥ â†’ äºŒåˆ†ç±»                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®æºæ–‡ä»¶

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| [src/Models/ss.py](src/Models/ss.py) | ä¸»æ¨¡å‹ï¼ˆSS ç±»ï¼‰- äº¤å‰æ³¨æ„åŠ› + é¢„æµ‹å¤´ |
| [src/Models/Structure/egnn.py](src/Models/Structure/egnn.py) | SE(3)-ç­‰å˜ GNN å®ç° |
| [src/Models/Structure/structure.py](src/Models/Structure/structure.py) | ä»ç»“æ„æ„å»ºå›¾ |
| [src/Datasets/brenda.py](src/Datasets/brenda.py) | æ•°æ®é›†åŠ è½½å’Œæ‰¹å¤„ç† |
| [src/Datasets/create_features.py](src/Datasets/create_features.py) | ESM åµŒå…¥ã€ååº”ç‰¹å¾ |
| [src/Datasets/Structure/protein_ligand.py](src/Datasets/Structure/protein_ligand.py) | å£è¢‹/é…ä½“è§£æ |
| [src/main_testing.py](src/main_testing.py) | æ¨ç†è„šæœ¬ |
| [src/example.ipynb](src/example.ipynb) | ç«¯åˆ°ç«¯å·¥ä½œæµç¨‹ç¤ºä¾‹ |

### æ¨ç†æ•°æ®æµç¨‹

**ä¸¤ä¸ªä¸»è¦é˜¶æ®µ**ï¼š1ï¼‰ç‰¹å¾å‡†å¤‡ï¼Œ2ï¼‰é¢„æµ‹ç”Ÿæˆ

#### é˜¶æ®µ 1ï¼šæ‰€éœ€è¾“å…¥æ–‡ä»¶

- `Enzymes.csv`ï¼šå¿…é¡»åŒ…å«åˆ— "Protein sequence"
- `Substrates.csv`ï¼šå¿…é¡»åŒ…å«åˆ— "Substrate_SMILES"
- `data.csv`ï¼šå¿…é¡»åŒ…å«åˆ— "Dock Index"ã€"Enzyme Index"ã€"Substrate Index"ã€"Label"
  - "Dock Index" dã€"Enzyme Index" eã€"Substrate Index" s è¡¨ç¤ºå¯¹æ¥ d æ˜¯é…¶ e å’Œåº•ç‰© s çš„å¤åˆç‰©
  - ç´¢å¼•å¿…é¡»ä¸è¯æ±‡æ–‡ä»¶ï¼ˆEnzymes.csvã€Substrates.csvï¼‰å¯¹é½
  - "Label" åˆ—å¯ä»¥éšæœºè®¾ç½®ä¸º 0 æˆ– 1ï¼ˆä»…ç”¨äºæµç¨‹æ‰§è¡Œï¼Œå¯¹é¢„æµ‹æ— æ„ä¹‰ï¼‰
- `Structure/complex/*.pdb`ï¼šå¯¹æ¥ç»“æœï¼Œéœ€ç¬¦åˆæ ¼å¼è¦æ±‚ï¼ˆè§ä¸‹æ–¹ PDB éƒ¨åˆ†ï¼‰

#### é˜¶æ®µ 2ï¼šç‰¹å¾ç”Ÿæˆé¡ºåº

éµå¾ª `example.ipynb` å·¥ä½œæµç¨‹ï¼š

**é˜¶æ®µ 1ï¼šé…¶ç‰¹å¾**
- ESM åµŒå…¥ â†’ `enzyme_features.lmdb`ï¼ˆè›‹ç™½è´¨ < 1000 ä¸ªæ°¨åŸºé…¸ï¼Œä»…æ ‡å‡†æ°¨åŸºé…¸ï¼‰

**é˜¶æ®µ 2ï¼šåº•ç‰©ç‰¹å¾**
- å›¾ç‰¹å¾ â†’ `reaction_features.lmdb`ï¼ˆåº•ç‰© < 275 ä¸ªåŸå­ï¼‰
- Morgan æŒ‡çº¹ â†’ `morgan_fingerprint.npy`ï¼ˆ1024-bitï¼‰
- GROVER åµŒå…¥ â†’ `grover_fingerprint.lmdb`ï¼ˆéœ€è¦å¤šä¸ªå­æ­¥éª¤ï¼Œè§ GROVER éƒ¨åˆ†ï¼‰

**é˜¶æ®µ 3ï¼šç»“æ„ç‰¹å¾**
- ä» PDB æ–‡ä»¶æå–å£è¢‹å’Œé…ä½“ â†’ `str_tmp_data/pocket/`ã€`str_tmp_data/ligand/`
- å¯¹é½å¯¹æ¥å’Œ SMILES è¡¨ç¤ºä¹‹é—´çš„åº•ç‰©ç¼–å·
- å¤„ç†ç»“æ„ç‰¹å¾ â†’ `structure_features.lmdb`ã€`str_features.lmdb`
- ç”Ÿæˆé«˜è´¨é‡ ID â†’ `high_quality_id.txt`ï¼ˆæœ‰æ•ˆå£è¢‹å’Œé…ä½“çš„äº¤é›†ï¼‰

#### é˜¶æ®µ 3ï¼šé¢„æµ‹è¾“å‡º

åŒ…å« "score" åˆ—çš„ CSVï¼ˆè¡¨ç¤ºç‰¹å¼‚æ€§çš„ logitsï¼‰

### PDB å¯¹æ¥æ–‡ä»¶æ ¼å¼è¦æ±‚

å¯¹æ¥ PDB æ–‡ä»¶å¿…é¡»éµå¾ªä»¥ä¸‹ä¸¥æ ¼æ ¼å¼è¦æ±‚ï¼š

- **è¾…å› å­å¤„ç†**ï¼šä»»ä½•è¾…å› å­ç›¸å…³åŸå­å¿…é¡»ä»¥ "HETATM" æ ‡è¯†ç¬¦å¼€å¤´ï¼ˆè¾…å› å­æ˜¯å¯é€‰çš„ï¼‰
- **åŸå­æ’åº**ï¼šè›‹ç™½è´¨/è¾…å› å­åŸå­å¿…é¡»åœ¨æ–‡ä»¶ä¸­ä½äºé…ä½“åŸå­ä¹‹å‰
- **åˆ†éš”ç¬¦è¦æ±‚**ï¼šè›‹ç™½è´¨/è¾…å› å­å’Œé…ä½“éƒ¨åˆ†å¿…é¡»é€šè¿‡ä»¥ä¸‹å†…å®¹åˆ†éš”ï¼š`COMPND    ***.pdbqt`
- **æ ‡å‡†åˆè§„æ€§**ï¼š
  - è›‹ç™½è´¨éƒ¨åˆ†å¿…é¡»ç¬¦åˆæ ‡å‡† PDB æ ¼å¼
  - é…ä½“éƒ¨åˆ†å¿…é¡»å¯è¢« RDKit åŒ…è§£æ
- **åæ ‡æå–**ï¼šå£è¢‹å®šä¹‰ä¸ºé…ä½“åŸå­ 10Ã… èŒƒå›´å†…çš„è›‹ç™½è´¨åŸå­ï¼ˆä¸åŒ…æ‹¬æ°¢ï¼‰

## é…ç½®

æ¨¡å‹é…ç½®åŸºäº YAMLï¼ˆå‚è§ `saved_model/model/run_0/complete-full-random-all-0-complex.yml`ï¼‰ï¼š

```yaml
model:
  hidden_dim: 128
  use_gnn: True
  graph:
    num_layers: 3
    attention: True
  cross_attention:
    n_head: 8
    dropout: 0.9
```

**å…³é”®è¶…å‚æ•°**ï¼š
- `max_enzyme_length`ï¼š1450 ä¸ªæ°¨åŸºé…¸
- `max_substrate_length`ï¼š280 ä¸ªåŸå­
- `batch_size`ï¼š16
- ç‰¹å¾ï¼šMorganï¼ˆ1024-bitï¼‰+ GROVER meanï¼ˆ4885-dimï¼‰+ GROVER atomï¼ˆ2400-dimï¼‰

## ä¾èµ–é¡¹

**æ ¸å¿ƒä¾èµ–é¡¹**ï¼š
- Python 3.10.12
- PyTorch 2.1.0 with CUDA 12.1
- PyTorch Geometricï¼ˆtorch_scatterã€torch_sparseã€torch_clusterï¼‰
- PyTorch Lightning 1.9.0
- RDKit 2023.9.2ï¼ˆåˆ†å­å¤„ç†ï¼‰
- BioPython 1.81ï¼ˆPDB è§£æï¼‰
- fair-esm 2.0.0ï¼ˆè›‹ç™½è´¨åµŒå…¥ï¼‰
- LMDB 1.4.1ï¼ˆç‰¹å¾å­˜å‚¨ï¼‰

**å®Œæ•´ä¾èµ–åˆ—è¡¨**ï¼šå‚è§ `src/environment.yml` è·å–å®Œæ•´çš„ conda ç¯å¢ƒè§„èŒƒã€‚

## ç ”ç©¶èƒŒæ™¯

æœ¬é¡¹ç›®åŸºäº EZSpecificityï¼ˆNature 2025ï¼‰åŸå§‹ä»£ç åº“ï¼Œå½“å‰æ­£åœ¨è¿›è¡Œ P450 é…¶å®¶æ—çš„ç‰¹å¼‚æ€§ç ”ç©¶ã€‚

### EZSpecificity åŸå§‹æ•°æ®é›†
- è®­ç»ƒæ•°æ®ï¼šæ¥è‡ª BRENDA çš„ 323,783 ä¸ªé…¶-åº•ç‰©å¯¹
- é…¶ç§ç±»ï¼š8,124 ç§ä¸åŒçš„é…¶
- è´Ÿæ ·æœ¬ç”Ÿæˆï¼šå•å‘éšæœºé‡‡æ ·ï¼ˆä»…é‡‡æ ·è´Ÿé…¶ï¼‰ï¼Œæ­£è´Ÿæ¯”ä¾‹ 1:9.36

### å½“å‰ P450 ç ”ç©¶æ–¹å‘

æœ¬é¡¹ç›®æ­£åœ¨è¿›è¡Œ P450 ç»†èƒè‰²ç´ é…¶å®¶æ—çš„ä¸“é¡¹ç ”ç©¶ï¼š

#### ç ”ç©¶æ–‡æ¡£ç´¢å¼•

| æ–‡æ¡£ | å†…å®¹ | ç”¨é€” |
|------|------|------|
| [P450_EZSpecificityå®Œæ•´ç ”ç©¶æ‰‹å†Œ_ç»ˆææ•´åˆç‰ˆ.md](P450_EZSpecificityå®Œæ•´ç ”ç©¶æ‰‹å†Œ_ç»ˆææ•´åˆç‰ˆ.md) | ESIBank æ„å»ºåŸç†ã€ç ”ç©¶è·¯å¾„åˆ†æã€æ ¸å¿ƒæ¦‚å¿µè¯¦è§£ | æ€»çº²æ€§æ–‡æ¡£ï¼Œç†è§£å…¨å±€ |
| [æå–P450è¿‡ç¨‹æ—¥å¿—/é¡¹ç›®è¿›åº¦æ—¥å¿—.md](æå–P450è¿‡ç¨‹æ—¥å¿—/é¡¹ç›®è¿›åº¦æ—¥å¿—.md) | åŠ¨æ€æ›´æ–°çš„å·¥ä½œæ—¥å¿—ã€ç‰ˆæœ¬åŒ–çš„å·¥ä½œèŠ‚ç‚¹ | è¿½è¸ªè¿›åº¦ã€å›æº¯å†å² |
| [P450æ•°æ®é›†æ„å»ºå‰æœŸæŠ¥å‘Š/](P450æ•°æ®é›†æ„å»ºå‰æœŸæŠ¥å‘Š/) | æˆ˜ç•¥è§„åˆ’ã€æ“ä½œæŒ‡å—ã€é˜¶æ®µæ€§æŠ¥å‘Š | å…·ä½“å®æ–½æ–¹æ¡ˆ |
| [å¯¼å¸ˆè„šæœ¬/](å¯¼å¸ˆè„šæœ¬/) | æ•°æ®æå–è„šæœ¬ã€æ•™ç¨‹æ–‡æ¡£ | æŠ€æœ¯å·¥å…· |

#### å…³é”®æ•°æ®èµ„äº§

```
P450 æ•°æ®å±‚çº§ç»“æ„ï¼š

ESIBank è®­ç»ƒé›†ä¸­çš„ P450
â”œâ”€â”€ 389 ä¸ªå·²éªŒè¯çš„ P450 é…¶ï¼ˆä» 25,225 ä¸ªé…¶ä¸­ç­›é€‰ï¼‰
â”‚   â”œâ”€â”€ æ¥æºï¼šUniProt + InterPro åŒé‡éªŒè¯
â”‚   â”œâ”€â”€ ç»“æ„ï¼šå¤§å¤šä½¿ç”¨ AlphaFold é¢„æµ‹ç»“æ„
â”‚   â””â”€â”€ ç”¨é€”ï¼šEZSpecificity åŸå§‹æ¨¡å‹çš„è®­ç»ƒæ•°æ®å­é›†
â”‚
ç‹¬ç«‹æµ‹è¯•é›†ï¼ˆæœ¬ç ”ç©¶é‡ç‚¹ï¼‰
â””â”€â”€ 161 ä¸ªæœ‰ PDB å®éªŒç»“æ„çš„ P450
    â”œâ”€â”€ æ¥æºï¼šRCSB PDB æ•°æ®åº“
    â”œâ”€â”€ ç»“æ„ï¼šX-ray/Cryo-EM å®éªŒè§£æçš„é«˜è´¨é‡ç»“æ„
    â”œâ”€â”€ ç‰¹ç‚¹ï¼šæ¨¡å‹ä»æœªè§è¿‡çš„ç‹¬ç«‹æ•°æ®
    â””â”€â”€ ç”¨é€”ï¼šéªŒè¯æ¨¡å‹åœ¨ P450 ä¸Šçš„é¢„æµ‹èƒ½åŠ›
```

#### å½“å‰ç ”ç©¶é˜¶æ®µ

**é˜¶æ®µåå…­**ï¼šå››è·¯å¾„ç ”ç©¶é¡¹ç›®æ­£å¼å¯åŠ¨ï¼ˆ2026-01-08ï¼‰

| è·¯å¾„ | åç§° | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| **A** | æ¨¡å‹è¯„ä¼°æµ‹è¯•é›†æ„å»º | ğŸš€ Step 0 å®Œæˆ | ç›®å½•åˆ›å»º+æ•°æ®å¤åˆ¶ |
| B | P450ä¸“å±æ•°æ®é›†æ„å»º | â³ å¾…å®š | è·¯å¾„Aå®Œæˆå |
| C | P450ä¸“å±æ¨¡å‹è®­ç»ƒ | â³ å¾…å®š | è·¯å¾„Bå®Œæˆå |
| D | åŒºåŸŸé€‰æ‹©æ€§é¢„æµ‹ | â³ å¾…å®š | è·¯å¾„Aå®Œæˆåå¯é€‰ |

**å·¥ä½œç›®å½•**: `P450_EZSpecificity_ç ”ç©¶é¡¹ç›®/PathA_2026-01-08_æ¨¡å‹è¯„ä¼°æµ‹è¯•é›†æ„å»º/`

**è®¡åˆ’æ–‡ä»¶**: `P450_EZSpecificity_ç ”ç©¶é¡¹ç›®/P450ç ”ç©¶å››è·¯å¾„è®¡åˆ’.md`

#### é‡è¦æ¦‚å¿µæ¾„æ¸…

**é…ä½“ï¼ˆLigandï¼‰vs åº•ç‰©ï¼ˆSubstrateï¼‰**ï¼š
- **PDB ä¸­çš„é…ä½“**ï¼šæ™¶ä½“ç»“æ„ä¸­ä¸è›‹ç™½ç»“åˆçš„ä»»ä½•å°åˆ†å­ï¼ˆå¯èƒ½æ˜¯åº•ç‰©ã€äº§ç‰©ã€æŠ‘åˆ¶å‰‚ã€è¾…å› å­ã€æº¶å‰‚ç­‰ï¼‰
- **BRENDA ä¸­çš„åº•ç‰©**ï¼šæ–‡çŒ®è¯å®çš„é…¶å‚¬åŒ–ååº”çš„ååº”ç‰©
- **å…³é”®åŒºåˆ«**ï¼šå¹¶éæ‰€æœ‰ PDB é…ä½“éƒ½æ˜¯é…¶çš„å‚¬åŒ–åº•ç‰©ï¼éœ€è¦æŸ¥é˜…æ–‡çŒ®éªŒè¯

**è´Ÿæ ·æœ¬ç”Ÿæˆæœºåˆ¶**ï¼ˆEZSpecificityï¼‰ï¼š
- æ–¹æ³•ï¼šå•å‘éšæœºé‡‡æ ·ï¼ˆåªéšæœºé…å¯¹è´Ÿé…¶ï¼Œä¿æŒåº•ç‰©ä¸å˜ï¼‰
- åŸå› ï¼šé¿å…é‡‡æ ·åˆ°çœŸå®çš„æ­£æ ·æœ¬å¯¹ï¼ˆæŸä¸ªåº•ç‰©å¯èƒ½è¢«å¤šä¸ªé…¶å‚¬åŒ–ï¼‰
- æ¯”ä¾‹ï¼šå®é™…æ•°æ®æ˜¾ç¤ºæ­£è´Ÿæ ·æœ¬æ¯”ä¸º 1:9.36

è¯¦è§å„ç ”ç©¶æ–‡æ¡£äº†è§£å®Œæ•´èƒŒæ™¯å’ŒæŠ€æœ¯ç»†èŠ‚ã€‚

## å¸¸è§é—®é¢˜ä¸æ•…éšœæ’é™¤

### ç‰¹å¾ç”Ÿæˆé—®é¢˜

**è›‹ç™½è´¨åºåˆ—è¿‡é•¿**ï¼š
- ESM åµŒå…¥ç”Ÿæˆä¼šè·³è¿‡ > 1000 ä¸ªæ°¨åŸºé…¸çš„è›‹ç™½è´¨
- è§£å†³æ–¹æ¡ˆï¼šæ‹†åˆ†é•¿åºåˆ—æˆ–ä½¿ç”¨æ›¿ä»£åµŒå…¥æ–¹æ³•

**éæ ‡å‡†æ°¨åŸºé…¸**ï¼š
- ç‰¹å¾ç”Ÿæˆè¿‡ç¨‹ä¸­ä¼šè·³è¿‡å«æœ‰éæ ‡å‡†æ°¨åŸºé…¸çš„åºåˆ—
- è§£å†³æ–¹æ¡ˆï¼šå°†éæ ‡å‡†æ°¨åŸºé…¸æ›¿æ¢ä¸ºæ ‡å‡†ç­‰æ•ˆç‰©æˆ–åˆ é™¤å—å½±å“çš„åºåˆ—

**åº•ç‰©è¿‡å¤§**ï¼š
- å›¾ç‰¹å¾ç”Ÿæˆä¼šè·³è¿‡ > 275 ä¸ªåŸå­çš„åº•ç‰©
- è§£å†³æ–¹æ¡ˆï¼šåˆ†å‰²å¤§åˆ†å­æˆ–è°ƒæ•´ `max_substrate_length` å‚æ•°

**RDKit è§£æå¤±è´¥**ï¼š
- PDB æ–‡ä»¶ä¸­çš„é…ä½“éƒ¨åˆ†å¿…é¡»ä¸ RDKit å…¼å®¹
- è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥é”®åºå’ŒåŸå­ç±»å‹ï¼›ç¡®ä¿æ­£ç¡®çš„ PDB æ ¼å¼

### ç»“æ„å¤„ç†é—®é¢˜

**å¯¹é½å¤±è´¥**ï¼š
- å¦‚æœå¯¹æ¥ PDB å’Œ SMILES ä¹‹é—´çš„åº•ç‰©å¯¹é½å¤±è´¥ï¼Œå·¥å…·ä¼šå°è¯•ä½¿ç”¨ SMILES ä½œä¸ºæ¨¡æ¿é‡æ–°åˆ†é…é”®åº
- è§£å†³æ–¹æ¡ˆï¼šéªŒè¯ SMILES ä¸å¯¹æ¥é…ä½“ç»“æ„åŒ¹é…

**ç¼ºå¤±åŸå­**ï¼š
- ç¡®ä¿é…ä½“ä¸­çš„æ‰€æœ‰é‡åŸå­éƒ½åœ¨è›‹ç™½è´¨åŸå­çš„åˆç†è·ç¦»å†…
- è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥å¯¹æ¥è´¨é‡ï¼›å¿…è¦æ—¶é‡æ–°å¯¹æ¥

**é«˜è´¨é‡ ID è¿‡æ»¤**ï¼š
- æœ€ç»ˆé¢„æµ‹ä»…ä½¿ç”¨å£è¢‹æå–å’Œé…ä½“å¯¹é½éƒ½æˆåŠŸçš„ç»“æ„
- è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ `high_quality_id.txt` æŸ¥çœ‹å“ªäº›ç»“æ„é€šè¿‡äº†è¿‡æ»¤

### ç¯å¢ƒé—®é¢˜

**Jupyter ä¸­çš„ DDP ç­–ç•¥é”™è¯¯**ï¼š
- PyTorch Lightning çš„ DDP ç­–ç•¥å¯èƒ½åœ¨äº¤äº’å¼ç¯å¢ƒä¸­å¤±è´¥
- è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ `main_testing.py` è„šæœ¬è€Œä¸æ˜¯ notebook è¿›è¡Œæœ€ç»ˆé¢„æµ‹ç”Ÿæˆ

**CUDA ç‰ˆæœ¬ä¸åŒ¹é…**ï¼š
- PyTorch Geometric åŒ…å¿…é¡»ä¸æ‚¨çš„ CUDA ç‰ˆæœ¬åŒ¹é…
- è§£å†³æ–¹æ¡ˆï¼šä¸ºæ‚¨çš„ CUDA å®‰è£…æ­£ç¡®çš„ PyG ç‰ˆæœ¬ï¼ˆè§å®‰è£…å‘½ä»¤ï¼‰

**Windows è·¯å¾„é—®é¢˜**ï¼š
- Unix é£æ ¼è·¯å¾„ï¼ˆ/ï¼‰å¯èƒ½åœ¨ Windows ä¸Šä¸èµ·ä½œç”¨
- è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ Windows é£æ ¼è·¯å¾„ï¼ˆ\ï¼‰æˆ–åŸå§‹å­—ç¬¦ä¸²ï¼ˆr"path\to\file"ï¼‰

### GROVER ç‰¹å¾ç”Ÿæˆ

**PYTHONPATH è¦æ±‚**ï¼š
- è¿è¡Œè„šæœ¬å‰å¿…é¡»å°† PYTHONPATH è®¾ç½®ä¸º GROVER ç›®å½•
- è§£å†³æ–¹æ¡ˆï¼š`export PYTHONPATH=<project_root>/src/other_softwares/grover_software:$PYTHONPATH`ï¼ˆLinux/Macï¼‰æˆ– `set PYTHONPATH=<project_root>\src\other_softwares\grover_software;%PYTHONPATH%`ï¼ˆWindowsï¼‰

**æ£€æŸ¥ç‚¹ä½ç½®**ï¼š
- éªŒè¯ `grover_large.pt` è·¯å¾„ä¸æ‚¨çš„è®¾ç½®åŒ¹é…
- è§£å†³æ–¹æ¡ˆï¼šå¦‚æœç¼ºå¤±ï¼Œä»åŸå§‹ GROVER ä»“åº“ä¸‹è½½ï¼›æ”¾ç½®åœ¨ `data/pretrain_model/`

**å¤šæ­¥éª¤æµç¨‹**ï¼š
- GROVER éœ€è¦ä¸‰ä¸ªè¿ç»­æ­¥éª¤ï¼ˆsave_features â†’ build_vocab â†’ fingerprintï¼‰
- è§£å†³æ–¹æ¡ˆï¼šæŒ‰ GROVER éƒ¨åˆ†ä¸­çš„ç¡®åˆ‡é¡ºåºæ‰§è¡Œï¼›ä¸è¦è·³è¿‡æ­¥éª¤

### å¸¸è§é”™è¯¯æ¶ˆæ¯

**"CUDA out of memory"**ï¼š
- åœ¨é…ç½®æ–‡ä»¶ä¸­å‡å°‘æ‰¹é‡å¤§å°
- ä½¿ç”¨æ›´å°çš„æ¨¡å‹æˆ–æ›´å°‘çš„å±‚
- åˆ†å—å¤„ç†æ•°æ®

**"LMDB file not found"**ï¼š
- ç‰¹å¾æ–‡ä»¶å°šæœªç”Ÿæˆ
- è§£å†³æ–¹æ¡ˆï¼šæŒ‰æ­£ç¡®é¡ºåºè¿è¡Œç‰¹å¾ç”Ÿæˆæ­¥éª¤ï¼ˆè§æ¨ç†æ•°æ®æµç¨‹ï¼‰

**"Invalid PDB format"**ï¼š
- PDB æ–‡ä»¶ä¸ç¬¦åˆæ ¼å¼è¦æ±‚
- è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ PDB æ ¼å¼è¦æ±‚éƒ¨åˆ†ï¼›ç¡®ä¿æ­£ç¡®çš„åˆ†éš”ç¬¦è¡Œ

**"Sequence contains invalid characters"**ï¼š
- è›‹ç™½è´¨åºåˆ—ä¸­å«æœ‰éæ ‡å‡†æ°¨åŸºé…¸
- è§£å†³æ–¹æ¡ˆï¼šä»…ä½¿ç”¨æ ‡å‡† 20 ç§æ°¨åŸºé…¸


