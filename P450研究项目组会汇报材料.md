# P450-EZSpecificity研究：构建高质量独立测试集
## 从数据清洗到模型评估的完整流程

> **项目地址**：https://github.com/Tsukizzh/Undergraduate_Thesis

---

## 一、研究背景

### 1.1 关键数据库介绍

#### BRENDA数据库

**BRENDA**（Braunschweig Enzyme Database）是全球最大的**酶功能数据库**。

| 特点 | 说明 |
|------|------|
| **数据来源** | 必须来自发表的科学论文 |
| **数据类型** | 酶-底物关系、动力学参数、物种来源 |
| **质量保证** | 专业团队人工整理，不收录预测数据 |

**通俗理解**：BRENDA就像一本"酶的百科全书"，记录了哪个酶能催化什么底物。

#### UniProt数据库

**UniProt**（Universal Protein Resource）是全球最大的**蛋白质序列和功能数据库**。

| 特点 | 说明 |
|------|------|
| **核心功能** | 提供蛋白质序列、功能注释、结构域信息 |
| **关键字段** | UniProt ID（唯一标识）、InterPro域、蛋白质家族 |
| **数据规模** | Swiss-Prot（人工审核）~57万条 + TrEMBL（自动注释）~2.5亿条 |

**通俗理解**：UniProt就像"蛋白质的身份证大全"，每个蛋白质都有唯一的ID和详细档案。

---

### 1.2 ESIBank数据集构建流程

ESIBank是EZSpecificity的训练数据集，核心思路是**"关系优先，结构其次"**：

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     ESIBank 数据构建流程图                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   Step 1: BRENDA原始数据收集                                             │
│           ├── 收集酶-底物对关系                                          │
│           ├── 收集底物SMILES化学结构                                     │
│           └── 收集EC号和物种信息                                         │
│           ▼                                                             │
│   Step 2: UniProt序列匹配                                                │
│           ├── 用EC号 + 物种名称匹配UniProt酶序列                          │
│           ├── 获取酶的完整氨基酸序列                                      │
│           └── 获取UniProt ID作为唯一标识                                  │
│           ├── ⚠️ 筛除：无法映射到UniProt的                                │
│           ├── ⚠️ 筛除：序列不完整或为片段的                                │
│           ▼                                                             │
│   Step 3: 底物SMILES标准化                                               │
│           ├── 底物必须有机器可读的SMILES结构                              │
│           └── 使用GROVER模型生成分子指纹                                  │
│           ├── ⚠️ 筛除：底物名称不规范（如"脂肪酸"、"类固醇"）              │
│           ├── ⚠️ 筛除：无法转换为SMILES的                                  │
│           ▼                                                             │
│   Step 4: 正样本确认                                                     │
│           ├── 确认酶-底物对有反应关系（来自BRENDA文献）                    │
│           └── 标记为 label = 1（正样本）                                  │
│           ▼                                                             │
│   Step 5: 负样本生成 ← 关键步骤！                                         │
│           ├── 单向随机采样：固定底物X，随机配对负酶B、C...                 │
│           ├── 实际数据：56,597正样本 → 529,918负样本                      │
│           └── 实际比例 = 1:9.36                                          │
│           ▼                                                             │
│   Step 6: 酶序列嵌入                                                     │
│           ├── 使用ESM-2模型将氨基酸序列转为嵌入向量                        │
│           └── 存储到 enzyme_features.lmdb                                │
│           ▼                                                             │
│   Step 7: 3D结构获取                                                     │
│           ├── 使用AlphaFold数据库获取预测结构                             │
│           └── 使用AlphaFill填充配体位置                                   │
│           ▼                                                             │
│   Step 8: 分子对接                                                       │
│           ├── 使用AutoDock-GPU进行酶-底物对接                             │
│           └── 生成酶-底物复合物3D坐标                                     │
│           ▼                                                             │
│   最终输出：ESIBank训练数据集                                             │
│           ├── enzymes.csv      → 25,225个酶（序列+UniProt ID）            │
│           ├── data.csv         → 586,515个酶-底物对（含正负样本）          │
│           ├── reaction.csv     → 底物SMILES和反应信息                     │
│           └── Structure/complex/ → 对接复合物PDB文件                      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

**阶段一：数据收集与匹配**

| 步骤 | 具体操作 | 产出 |
|------|----------|------|
| **Step 1** | 从BRENDA收集酶-底物催化关系（文献验证的正样本） | 酶-底物关系表 |
| **Step 2** | 用UniProt ID匹配每个酶的完整氨基酸序列 | 25,225个酶序列 |
| **Step 3** | 将底物名称转换为标准化SMILES格式 | 机器可读的分子结构 |

**阶段二：样本构建**

| 步骤 | 具体操作 | 产出 |
|------|----------|------|
| **Step 4** | 确认正样本（BRENDA记录的酶-底物对，label=1） | 56,597个正样本 |
| **Step 5** | 生成负样本：固定底物，随机配对不催化该底物的酶（文献中是双向，实际代码是单向） | 529,918个负样本 |

**阶段三：特征生成**

| 步骤 | 具体操作 | 产出 |
|------|----------|------|
| **Step 6** | 用ESM-2模型将酶序列转换为嵌入向量 | 酶特征（1280维） |
| **Step 7** | 用AlphaFold预测每个酶的3D结构 | 蛋白质结构文件 |
| **Step 8** | 用AutoDock-GPU将底物对接到酶结构上 | 酶-底物复合物 |

**关键点：负样本生成机制**
- 方法：单向随机采样（固定底物X，随机配对负酶B、C...）
- 原因：避免采样到真实的正样本（某个底物可能被多个酶催化）
- 比例：正负样本比 = 1:9.36

**最终产出**（EZSpecificity输入格式）：
- `Enzymes.csv`：酶序列（Protein sequence列）
- `Substrates.csv`：底物SMILES（Substrate_SMILES列）
- `data.csv`：酶-底物配对索引（Enzyme Index, Substrate Index, Dock Index, Label）
- `Structure/complex/`：对接复合物PDB文件

---

### 1.3 P450研究四路径规划

| 路径 | 目标 | 前置条件 | 状态 |
|------|------|----------|------|
| **A** | 用158个PDB评估EZSpecificity模型（初步尝试） | 无 | 🔄 当前执行 |
| **B** | 构建P450专属训练数据集（以路径A为基础扩大样本量） | 路径A完成 | ⏳ 待定 |
| **C** | 训练或微调P450专属模型 | 路径B完成 | ⏳ 待定 |
| **D** | 区域选择性预测 | 路径A效果好 | ⏳ 待定 |

**决策逻辑**：
- 路径A结果**优秀**（>80%）→ 直接进入路径D（区域选择性预测）
- 路径A结果**良好**（60-80%）→ 分析失败案例，考虑微调
- 路径A结果**较差**（<60%）→ 执行路径B+C（构建数据集+训练专属模型）

**路径A执行步骤**：

| 阶段 | 步骤 | 任务 | 产出 |
|------|------|------|------|
| **数据清洗** | Step 1 | 下载158个PDB文件 | pdb_files/ |
| | Step 2 | 提取酶序列 | Enzymes.csv |
| | Step 3 | 提取配体信息 | Substrates.csv |
| | Step 4 | 构建索引表 | data.csv |
| | Step 5 | PDB格式转换（HEM处理） | Structure/complex/ |
| **特征生成** | Step 6 | 生成酶特征（ESM-2） | enzyme_features.lmdb |
| | Step 7 | 生成底物特征（GROVER+Morgan） | 多个特征文件 |
| | Step 8 | 处理结构特征 | structure_features.lmdb |
| **预测分析** | Step 9 | 运行EZSpecificity预测 | predictions.csv |
| | Step 10 | 分析预测结果 | 评估报告 |

---

### 1.4 实验总体进度

```
┌─────────────────────────────────────────────────────────────┐
│                    研究进度总览                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ✅ 已完成                                                 │
│   ├── P450精确识别（EC号→InterPro域验证）                     │
│   ├── PDB结构数据集构建（1,591→186→158）                      │
│   ├── 数据泄露排除（25个交集已剔除）                           │
│   ├── 数据清洗（移除6ZZX非P450）                              │
│   ├── Step 1：下载158个PDB文件                               │
│   ├── Step 2：提取158条酶序列 → Enzymes.csv                  │
│                                                             │
│                                                             │
│   🔄 进行中                                                 │
│   └── 路径A：模型评估测试集构建（正在Step3）                               │
│                                                             │
│   ⏳ 待执行                                                 │
│   └── Step 4-10：索引表构建、特征提取与模型预测                │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 二、实验一：ESIBank中P450酶的精确识别

### 2.1 问题发现：EC号筛选的陷阱

**初始方法**：用EC号（1.14.14.*）筛选P450

**初始结果**：找到4,121个"P450"

**抽样验证发现严重问题**：

```
验证案例：P07327
├── data.csv中标记为：EC 1.14.14.126（P450相关EC号）
├── UniProt查询结果：
│   ├── 蛋白名：Alcohol dehydrogenase 1A（醇脱氢酶）
│   ├── 真实EC：1.1.1.1（不是1.14.14.126）
│   └── 辅因子：Zn²⁺（锌离子，不是P450特征的Heme血红素）
└── 结论：这根本不是P450酶
```

**根本原因分析**：
- EC号分类的是**反应类型**，不是**酶的身份**
- 同一个酶可以催化多种EC类别的反应
- FAD单加氧酶、黄素蛋白单加氧酶等都可能有EC 1.14.14.*编号

### 2.2 实验方法：UniProt批量验证

**验证标准设计**：
1. **主标准**：UniProt `protein_families`字段包含"Cytochrome P450"
2. **备用标准**：InterPro域包含IPR001128（P450核心域）、IPR036396（P450超家族）
   - *InterPro是蛋白质功能域数据库，通过序列特征识别蛋白质家族，比EC号更精确*
3. **排除条件**：排除"P450 Reductase"（电子传递伙伴，不是P450本身）

**P450识别流程图**：

```
                    ┌─────────────────────┐
                    │ 输入：25,225个酶     │
                    │ (enzymes.csv)        │
                    └──────────┬──────────┘
                               │
                               ▼
                    ┌─────────────────────┐
                    │ 查询UniProt API      │
                    │ 获取三个字段：        │
                    │ - protein_families   │
                    │ - xref_interpro      │
                    │ - cc_cofactor        │
                    └──────────┬──────────┘
                               │
                               ▼
              ┌────────────────────────────────────┐
              │ 检查InterPro域是否包含P450特征域？   │
              │ (IPR001128, IPR036396, IPR002401等) │
              └────────────────┬───────────────────┘
                               │
              ┌────────────────┴────────────────┐
              │                                 │
              ▼                                 ▼
        ┌─────────┐                       ┌─────────┐
        │ 是      │                       │ 否      │
        └────┬────┘                       └────┬────┘
             │                                 │
             ▼                                 ▼
    ┌─────────────────┐           ┌────────────────────────┐
    │ ✅ 确认是P450    │           │ 检查protein_families   │
    │                 │           │ 是否包含"P450"？        │
    │ is_p450 = True  │           └───────────┬────────────┘
    │                 │                       │
    │ 共389个         │          ┌────────────┴────────────┐
    └─────────────────┘          │                         │
                                 ▼                         ▼
                           ┌─────────┐               ┌─────────┐
                           │ 是      │               │ 否      │
                           └────┬────┘               └────┬────┘
                                │                         │
                                ▼                         ▼
                   ┌────────────────────┐       ┌─────────────────┐
                   │ 是否包含"reductase"？│       │ ❌ 非P450       │
                   └─────────┬──────────┘       │                 │
                             │                  │ 共24,815个      │
                ┌────────────┴────────────┐     └─────────────────┘
                │                         │
                ▼                         ▼
          ┌─────────┐               ┌─────────┐
          │ 是      │               │ 否      │
          └────┬────┘               └────┬────┘
               │                         │
               ▼                         ▼
    ┌─────────────────────┐    ┌─────────────────┐
    │ ⚠️ P450 Reductase   │    │ ⚠️ 需要人工审核 │
    │ 排除                │    │ (理论上应为0)   │
    │                     │    │                 │
    │ 共21个              │    └─────────────────┘
    └─────────────────────┘
```

**实现过程**：

```
实验步骤：
1. 编写脚本调用UniProt REST API
2. 对25,225个酶进行批量查询（分批处理，每批150个）
3. 使用SQLite缓存避免重复查询
4. 解析返回的JSON数据，提取protein_families和InterPro域信息

遇到的问题：
├── 问题1：POST请求返回HTTP 400错误
│   └── 解决：改用GET请求，将参数编码到URL中
├── 问题2：批量查询URL过长
│   └── 解决：将批量大小从100减少到150
└── 问题3：网络不稳定导致查询中断
    └── 解决：使用SQLite缓存已查询结果，支持断点续传
```

**产出文件**：
- `P450识别脚本.py`：最终版识别脚本
- `UniProt查询缓存.db`：SQLite缓存（避免重复查询）
- `P450酶列表_最终版389个.csv`：经过验证的P450酶列表

### 2.3 实验结果与验证

**初步筛选结果**：
| 类别 | 数量 |
|------|------|
| P450相关（protein_families含"P450"）| 410 |
| 其中P450 Reductase（需排除）* | 21 |
| **真正的P450酶** | **389** |

> *P450 Reductase（细胞色素P450还原酶）是P450的电子传递伙伴，负责向P450提供电子。它名字里有"P450"是因为与P450协同工作，但它本身不是P450酶——P450含血红素（Heme），而Reductase含FAD/FMN辅因子，结构和功能完全不同。

**补充验证实验**：
1. **抽样检查**：随机抽样100个被排除酶 → 0个含P450域
2. **额外InterPro检查**：检查IPR002397/002403等 → 0个遗漏
3. **Pfam交叉验证**：用PF00067验证 → 已识别P450中99.7%含PF00067

### 2.4 实验结论

| 方法 | 识别数量 | 假阳性率 | 可靠性 |
|------|---------|---------|--------|
| EC号筛选 | 4,121 | **~90%** | ❌ 不可用 |
| InterPro验证 | **389** | **~0%** | ✅ 可靠 |

**关键结论**：ESIBank中真正的P450只有**389个**（占25,225个酶的1.5%）

**为什么ESIBank只有389个P450？**

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    P450数据从全球到ESIBank的漏斗                          │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   全球已知P450序列                                    >300,000           │
│           │                                                             │
│           ▼ 有任何实验活性数据（~1-5%）                                   │
│           │ （大多数P450只有序列，没有功能实验）                           │
│                                                                         │
│   有实验数据的P450                                   ~3,000-15,000       │
│           │                                                             │
│           ▼ 有定量底物特异性数据（~10-20%）                               │
│           │ （需要明确"哪个底物被催化"的记录）                             │
│                                                                         │
│   有底物特异性数据                                   ~1,000-3,000        │
│           │                                                             │
│           ▼ BRENDA已收录                                                │
│           │ （BRENDA只收录发表论文中的数据）                              │
│                                                                         │
│   BRENDA中的P450                                    ~1,500-2,000        │
│           │                                                             │
│           ▼ 能映射到UniProt + 有机器可读SMILES（~20-50%）                 │
│           │ （底物名称必须能转换为标准化学结构）                           │
│                                                                         │
│   可用于机器学习                                     ~200-800            │
│           │                                                             │
│           ▼ 通过ESIBank质量过滤（去重、数据清洗等）                       │
│                                                                         │
│   ESIBank最终P450数量                                389                 │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

**产出文件**：
- `P450酶列表_最终版389个.csv`：389个真正P450酶的UniProt ID列表
- `P450精确验证报告.md`：完整验证报告
- `P450筛选方法详解.md`：筛选逻辑详细文档

---

## 三、实验二：RCSB PDB独立测试集构建

### 3.1 实验目的

从RCSB PDB数据库获取有实验结构的P450酶，构建模型从未见过的独立测试集。

### 3.2 RCSB搜索与数据获取

**搜索条件**：
- Pfam: PF00067（P450家族）
- InterPro域验证

**搜索结果**：1,591个P450聚合物实体

**数据获取过程**：
```
1. 使用RCSB Search API进行结构化查询
2. 获取每个实体的详细元数据：
   ├── 分辨率
   ├── 序列长度
   ├── 物种来源
   ├── UniProt ID
   └── 配体信息
3. 结果存入SQLite数据库便于后续筛选
```

**筛选漏斗**：

```
输入数据                    ┌─────────────────┐
(RCSB搜索结果)              │  1,591个 实体   │
                           └────────┬────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│ Step 1: 质量筛选                                                     │
│         ├── 分辨率 ≤ 3.0 Å（排除模糊结构）                            │
│         └── 序列长度 300-1200 aa（排除片段/融合蛋白）                  │
├─────────────────────────────────────────────────────────────────────┤
│         排除：7个无分辨率 + 99个低分辨率 + 59个短序列                   │
│         结果：1,426个                                                │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│ Step 2: 配体筛选                                                     │
│         ├── 必须有非辅因子配体（真正的底物/抑制剂/药物）                 │
│         └── 排除仅有HEM/水/缓冲盐的结构                               │
├─────────────────────────────────────────────────────────────────────┤
│         排除列表（50+化合物）：                                        │
│         ├── 血红素：HEM, HEC, HEA, HEB, HAS                          │
│         ├── 辅酶：FAD, FMN, NAD, NAP, NDP                            │
│         ├── 水/离子：HOH, H2O, NA, CL, K, MG, CA, ZN, FE             │
│         ├── 缓冲盐：SO4, PO4, ACT, EDO, TRS                          │
│         ├── 实验添加剂：GOL, PEG, PGE, MPD, DMS, 1PE, P6G            │
│         └── 醇类溶剂：IPA, MOH, EOH, IPH                             │
├─────────────────────────────────────────────────────────────────────┤
│         排除：280个仅有辅因子的结构                                    │
│         结果：1,146个                                                │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│ Step 3: 去冗余                                                       │
│         ├── 按UniProt ID分组                                         │
│         └── 每组只保留分辨率最好的那个结构                              │
├─────────────────────────────────────────────────────────────────────┤
│         去除：960个冗余结构                                           │
│         结果：186个独特的P450                                         │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                           ┌─────────────────┐
去冗余后                    │   186个 P450    │
                           └────────┬────────┘
                                    │
                    （后续：数据泄露排除 → 158个）
```

**筛选过程中发现的问题与修复**（v2→v3→v4迭代）：

| 版本 | 发现的问题 | 修复内容 |
|------|-----------|----------|
| v2 | 物种分类错误（Trypanosoma被分为bacteria） | 建立静态TAXONOMY_CATEGORY_MAP |
| v3 | 序列长度上限600aa排除了P450 BM3 | 提高上限至1200aa |
| v3 | IPA（异丙醇）被当作底物 | 扩展辅因子排除列表 |
| v4 | PEG（聚乙二醇）被当作底物 | 继续扩展排除列表（+50种化合物） |

### 3.4 数据泄露排除

**问题**：如果测试集中的P450已经在ESIBank训练集中出现过，模型评估就不公平。

**排除过程**：
```
1. 提取186个PDB P450的UniProt ID
2. 与ESIBank 389个P450的UniProt ID进行比对
3. 发现25个重叠的UniProt ID（对应26条记录，因P19099有2个PDB）
4. 从测试集中排除这26条记录
5. 最终得到159个独立测试P450结构
```

```
┌─────────────────────────────────────────────────────────────┐
│     ESIBank P450              PDB P450                      │
│    ┌───────────┐            ┌───────────┐                   │
│    │           │            │           │                   │
│    │   364     │     25     │    159    │                   │
│    │ (无PDB)   │  (交集)     │ (独立)    │                   │
│    │           │            │           │                   │
│    └───────────┘            └───────────┘                   │
│    总计：389个               总计：186个→159个               │
└─────────────────────────────────────────────────────────────┘
```

### 3.5 最终测试集物种分布

| 物种类别 | 数量 | 占比 |
|----------|------|------|
| bacteria（细菌） | 100 | 53.8% |
| other（其他） | 41 | 22.0% |
| mammals（哺乳动物） | 33 | 17.7% |
| plants（植物） | 7 | 3.8% |
| fungi（真菌） | 5 | 2.7% |

**说明**：细菌P450占主导是因为细菌P450通常是可溶性蛋白，容易结晶；植物/哺乳动物P450多是膜蛋白，结晶困难。

### 3.6 实验产出文件

| 文件 | 说明 |
|------|------|
| `全部P450结构_1591个.csv` | RCSB搜索原始结果 |
| `高质量P450全集_1426个.csv` | 质量筛选后 |
| `ML训练数据集_186个.csv` | 去冗余后 |
| `ML训练数据集_159个.csv` | 排除交集后（最终版） |
| `数据质量修复脚本.py` | v2→v4迭代修复脚本 |

---

## 四、路径A执行进度：模型评估测试集构建

### 4.1 Step 1：PDB文件下载

**执行内容**：
```
1. 读取ML训练数据集_186个.csv
2. 排除25个与ESIBank重叠的UniProt ID（对应26条记录）
3. 对剩余159个PDB ID调用RCSB下载API
4. 自动处理格式差异（部分结构仅提供mmCIF格式）
```

**下载结果统计**：

| 格式 | 数量 | 说明 |
|------|------|------|
| .pdb | 154个 | 传统PDB格式 |
| .cif | 5个 | mmCIF格式（较新结构） |
| **总计** | **159个** | 全部下载成功 |

**文件存放位置**：`P450_EZSpecificity_研究项目/PathA_.../data/01_pdb_files/`

### 4.2 Step 2-3：序列与配体提取

**Step 2：提取酶序列**
- 从源数据sequence列提取158条完整序列（RCSB deposited sequence）
- 产出：`Enzymes.csv`（158行）
- 技术修正：原计划从PDB文件提取，发现150/158个长度不一致，改用源数据

**Step 3：提取配体信息**
- 使用API获取134个配体的SMILES
- 配体分类：substrate(48), inhibitor(24), unknown(88), exclude(16)
- 产出：`Substrates.csv`（排除配体为缓冲液、洗涤剂等，并且去重后，还有125个唯一SMILES）

**重要发现：多配体问题**

158个PDB → 160个有效酶-配体对（有些PDB有多个配体）

例如：某个PDB结构中同时包含底物和产物，或者同时包含底物和抑制剂，这些都会被提取为独立的酶-配体对。

**问题根源：ESIBank vs 我们的流程差异**

| 方面 | ESIBank | 我们 |
|------|---------|------|
| **数据流** | 关系优先→结构其次 | 结构优先→关系推断 |
| **起点** | BRENDA酶-底物关系（文献验证） | PDB实验结构 |
| **对接** | AutoDock一次一个底物 | 直接使用PDB配体 |
| **配体来源** | 已知是底物 | 可能是底物/产物/抑制剂 |

- ESIBank从BRENDA获取"酶A催化底物X"的关系，然后为每个关系单独做AutoDock对接，每个复合物天然只有一个目标配体
- 我们直接从PDB拿实验结构，PDB是晶体学实验的记录，配体是实验条件的产物，可能同时有底物+产物+抑制剂
  - 例如：P450cam（CYP101A1）的晶体结构中可能同时包含樟脑（底物）和5-羧基樟脑（产物），这两个都会被提取为独立的酶-配体对

**三种解决方案**

**方案A：严格筛选（只用共晶底物）**
- **做法**：查阅文献，逐一确认每个PDB配体是否为该酶的真正底物，只保留确认是底物的酶-配体对
- **优点**：数据质量最高，标签可靠，预测结果可信度高
- **缺点**：需要大量人工查阅文献，耗时较长，数据量会减少约40%


**方案B：多配体展开（直接使用）**
- **做法**：不区分底物/产物/抑制剂，把所有提取到的每个配体都当作单独的"酶-配体对"输入模型
- **优点**：最快速，不需要额外工作，可以立即开始后续流程
- **缺点**：标签可能不准确（产物/抑制剂被当作底物），但可以观察模型对不同类型配体的预测差异


**方案C：虚拟对接（ESIBank风格）**
- **做法**：去掉PDB中的配体，查阅文献或其他数据库找到该酶的真正底物，然后用AutoDock将真正底物对接到我们的PDB实验结构（酶）上
- **优点**：酶结构是实验解析的高质量结构，底物标签可靠（文献验证），与ESIBank训练数据生成方式一致
- **缺点**：需要查阅文献确认底物、额外的对接工作，计算耗时最长


**执行计划**：B → A → C

### 4.3 后续待执行步骤

| 步骤 | 任务 | 状态 |
|------|------|------|
| Step 2 | 提取酶序列 → Enzymes.csv | ✅ 已完成 |
| Step 3 | 提取配体信息 → Substrates.csv | 正在进行 |
| Step 4 | 构建索引表 → data.csv | ⏳ 待开始 |
| Step 5 | 转换PDB格式（HEM处理） | ⏳ 待开始 |
| Step 6 | 生成酶特征（ESM-2） | ⏳ 待开始 |
| Step 7 | 生成底物特征（GROVER+Morgan） | ⏳ 待开始 |
| Step 8 | 处理结构特征 | ⏳ 待开始 |
| Step 9 | 运行EZSpecificity预测 | ⏳ 待开始 |
| Step 10 | 分析预测结果 | ⏳ 待开始 |

---

**附录：项目文件索引**

| 类别 | 文件位置 |
|------|----------|
| 389个P450列表 | `提取P450过程日志/2026-01-02_01-46_P450精确验证/` |
| 159个测试集 | `提取P450过程日志/2026-01-04_01-00_.../任务3_.../修复后最终版/` |
| PDB文件 | `P450_EZSpecificity_研究项目/PathA_.../data/01_pdb_files/` |
| 项目进度日志 | `提取P450过程日志/项目进度日志.md` |


